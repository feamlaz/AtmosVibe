import{r as i,m as E,R as S}from"./animation-CADzjvoS.js";import{r as L,c as N,R as _,L as R,X as M,Y as T,T as A,a as O}from"./charts-cMnazZIp.js";import{L as w,M as P,T as W,a as D,P as I,u as F}from"./maps-XLVWRgi1.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function a(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=a(r);fetch(r.href,o)}})();var y={exports:{}},f={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H=i,$=Symbol.for("react.element"),U=Symbol.for("react.fragment"),B=Object.prototype.hasOwnProperty,G=H.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,K={key:!0,ref:!0,__self:!0,__source:!0};function b(t,s,a){var n,r={},o=null,l=null;a!==void 0&&(o=""+a),s.key!==void 0&&(o=""+s.key),s.ref!==void 0&&(l=s.ref);for(n in s)B.call(s,n)&&!K.hasOwnProperty(n)&&(r[n]=s[n]);if(t&&t.defaultProps)for(n in s=t.defaultProps,s)r[n]===void 0&&(r[n]=s[n]);return{$$typeof:$,type:t,key:o,ref:l,props:r,_owner:G.current}}f.Fragment=U;f.jsx=b;f.jsxs=b;y.exports=f;var e=y.exports,p={},x=L;p.createRoot=x.createRoot,p.hydrateRoot=x.hydrateRoot;/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Z={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),V=(t,s)=>{const a=i.forwardRef(({color:n="currentColor",size:r=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:u,...m},d)=>i.createElement("svg",{ref:d,...Z,width:r,height:r,stroke:n,strokeWidth:l?Number(o)*24/Number(r):o,className:["lucide",`lucide-${z(t)}`,c].join(" "),...m},[...s.map(([k,C])=>i.createElement(k,C)),...Array.isArray(u)?u:[u]]));return a.displayName=`${t}`,a};/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=V("CloudSun",[["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}],["path",{d:"M15.947 12.65a4 4 0 0 0-5.925-4.128",key:"dpwdj0"}],["path",{d:"M13 22H7a5 5 0 1 1 4.9-6H13a3 3 0 0 1 0 6Z",key:"s09mg5"}]]);function q({onToggleTheme:t,theme:s}){return e.jsx("header",{className:"header safe-area-top",children:e.jsxs("div",{className:"container header-inner",children:[e.jsxs("div",{className:"brand",children:[e.jsx("span",{className:"brand-icon","aria-hidden":"true",children:e.jsx(Y,{size:22})}),e.jsx("span",{className:"brand-title",children:"AtmosVibe"})]}),e.jsx("button",{type:"button",className:"glass-button",onClick:t,children:s==="light"?"Тёмная тема":"Светлая тема"})]})})}function X(){return e.jsx("footer",{className:"footer safe-area-bottom",children:e.jsxs("div",{className:"container footer-inner",children:[e.jsx("span",{children:"AtmosVibe Weather"}),e.jsx("span",{className:"muted",children:"PWA • Vite • React"})]})})}function h({className:t,children:s}){return e.jsx("div",{className:N("glass-card",t),children:s})}function J({className:t,children:s,...a}){return e.jsx(E.button,{whileHover:{y:-1},whileTap:{y:0},transition:{duration:.15},className:N("glass-button",t),...a,children:s})}async function Q(t,s={}){const{force:a=!1}=s;return{locationName:"Демо режим",tempC:7,feelsLikeC:5,humidity:62,pressureHpa:1013,windMs:3.5,condition:"Clouds"}}async function ee(t,s={}){const{force:a=!1}=s;return[{t:"00:00",v:5},{t:"03:00",v:4},{t:"06:00",v:6},{t:"09:00",v:8},{t:"12:00",v:10},{t:"15:00",v:9},{t:"18:00",v:7},{t:"21:00",v:6}]}function g(){const[t,s]=i.useState(null),[a,n]=i.useState(null);return i.useEffect(()=>{if(!("geolocation"in navigator)){n(new Error("Geolocation unsupported"));return}const r=navigator.geolocation.watchPosition(o=>{s({lat:o.coords.latitude,lon:o.coords.longitude}),n(null)},o=>{console.warn("Geolocation error:",o),n(o)},{enableHighAccuracy:!0,maximumAge:6e4,timeout:1e4});return()=>navigator.geolocation.clearWatch(r)},[]),{coords:t,error:a}}function te(){const{coords:t}=g(),[s,a]=i.useState(null),[n,r]=i.useState(!0),[o,l]=i.useState(null),c=i.useCallback(async(m=!1)=>{r(!0),l(null);try{const d=await Q(t,{force:m});a(d)}catch(d){l(d)}finally{r(!1)}},[t==null?void 0:t.lat,t==null?void 0:t.lon]);i.useEffect(()=>{c(!1)},[c]);const u=i.useCallback(()=>c(!0),[c]);return{data:s,loading:n,error:o,refetch:u}}function j(t){return typeof t!="number"||Number.isNaN(t)?"—":`${Math.round(t)}°C`}function se(){const{data:t,loading:s,error:a,refetch:n}=te();return e.jsxs(h,{className:"widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx("h3",{className:"widget-title",children:"Сейчас"}),e.jsxs("div",{className:"widget-header-actions",children:[e.jsxs("span",{className:"muted",children:["Локация: ",(t==null?void 0:t.locationName)||"—"]}),e.jsx(J,{type:"button",onClick:n,disabled:s,title:"Обновить",children:a?"Повторить":"Обновить"})]})]}),s&&e.jsx("div",{className:"skeleton widget-skeleton"}),!s&&a&&e.jsx("p",{className:"muted",children:"Не удалось загрузить погоду. Проверь API ключ."}),!s&&!a&&t&&e.jsxs("div",{className:"current",children:[e.jsx("div",{className:"current-temp",children:j(t.tempC)}),e.jsx("div",{className:"muted",children:t.condition}),t.feelsLikeC!=null&&e.jsxs("div",{className:"muted",children:["Ощущается: ",j(t.feelsLikeC)]}),e.jsxs("div",{className:"current-meta",children:[e.jsxs("div",{children:[e.jsx("span",{className:"muted",children:"Влажность"}),e.jsxs("div",{children:[t.humidity,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"muted",children:"Ветер"}),e.jsxs("div",{children:[t.windMs," м/с"]})]}),t.pressureHpa!=null&&t.pressureHpa>0&&e.jsxs("div",{children:[e.jsx("span",{className:"muted",children:"Давление"}),e.jsxs("div",{children:[t.pressureHpa," hPa"]})]})]})]})]})}function re(){const{coords:t}=g(),[s,a]=i.useState(null),[n,r]=i.useState(!0),[o,l]=i.useState(null),c=i.useCallback(async(m=!1)=>{r(!0),l(null);try{const d=await ee(t,{force:m});a(d)}catch(d){l(d)}finally{r(!1)}},[t==null?void 0:t.lat,t==null?void 0:t.lon]);i.useEffect(()=>{c(!1)},[c]);const u=i.useCallback(()=>c(!0),[c]);return{data:s,loading:n,error:o,refetch:u}}const ae=[{t:"00:00",v:5},{t:"06:00",v:6},{t:"12:00",v:10},{t:"18:00",v:7}];function ne(){const{data:t,loading:s,error:a}=re(),n=t!=null&&t.length?t:ae;return e.jsxs(h,{className:"widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx("h3",{className:"widget-title",children:"Прогноз"}),e.jsx("span",{className:"muted",children:"Температура, 3 ч"})]}),s&&e.jsx("div",{className:"skeleton widget-skeleton"}),!s&&a&&e.jsx("p",{className:"muted",children:"Не удалось загрузить прогноз."}),!s&&!a&&n.length>0&&e.jsx("div",{style:{width:"100%",height:240},children:e.jsx(_,{children:e.jsxs(R,{data:n,children:[e.jsx(M,{dataKey:"t",stroke:"rgba(255,255,255,0.6)",fontSize:12}),e.jsx(T,{stroke:"rgba(255,255,255,0.6)",fontSize:12}),e.jsx(A,{contentStyle:{background:"rgba(15, 23, 42, 0.85)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:12},labelStyle:{color:"#f8fafc"},formatter:r=>[`${r} °C`,"Температура"]}),e.jsx(O,{type:"monotone",dataKey:"v",stroke:"#8b5cf6",strokeWidth:2,dot:!1})]})})})]})}delete w.Icon.Default.prototype._getIconUrl;w.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"});const oe=[55.751244,37.618423],ie=10;function le({center:t}){const s=F();return i.useEffect(()=>{t&&t[0]!=null&&t[1]!=null&&s.setView(t,s.getZoom())},[s,t]),null}function ce(){const{coords:t,error:s}=g(),a=t?[t.lat,t.lon]:oe,n=!!t;return s?e.jsxs(h,{className:"widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx("h3",{className:"widget-title",children:"Карта"}),e.jsx("span",{className:"muted",children:"Локация недоступна"})]}),e.jsx("div",{className:"map-placeholder",children:"Разрешите доступ к геолокации или обновите страницу."})]}):e.jsxs(h,{className:"widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx("h3",{className:"widget-title",children:"Карта"}),e.jsx("span",{className:"muted",children:n?"Ваша локация":"Центр по умолчанию"})]}),e.jsx("div",{className:"map-container",children:e.jsxs(P,{center:a,zoom:ie,scrollWheelZoom:!0,style:{height:"100%",width:"100%"},children:[e.jsx(W,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e.jsx(le,{center:a}),n&&e.jsx(D,{position:[t.lat,t.lon],children:e.jsx(I,{children:"Погода здесь"})})]})})]})}function de({checked:t,onChange:s,label:a}){return e.jsxs("label",{className:"toggle",children:[e.jsx("input",{className:"toggle-input",type:"checkbox",checked:t,onChange:s}),e.jsx("span",{className:"toggle-track","aria-hidden":"true",children:e.jsx("span",{className:"toggle-thumb"})}),e.jsx("span",{className:"toggle-label",children:a})]})}const v="atmosvibe-theme";function ue(){const t=i.useMemo(()=>{if(typeof window>"u")return"dark";const r=window.localStorage.getItem(v);return r==="light"||r==="dark"?r:window.matchMedia&&window.matchMedia("(prefers-color-scheme: light)").matches?"light":"dark"},[]),[s,a]=i.useState(t);return i.useEffect(()=>{document.documentElement.dataset.theme=s,window.localStorage.setItem(v,s)},[s]),{theme:s,toggleTheme:()=>a(r=>r==="light"?"dark":"light")}}function me(){const{theme:t,toggleTheme:s}=ue();return e.jsxs("div",{className:"app","data-theme":t,children:[e.jsx("div",{className:"background"}),e.jsx(q,{onToggleTheme:s,theme:t}),e.jsxs("main",{className:"container safe-area-top safe-area-left safe-area-right",children:[e.jsx("div",{className:"toolbar",children:e.jsx(de,{checked:t==="light",onChange:s,label:"Light"})}),e.jsxs("section",{className:"grid-responsive",children:[e.jsx(se,{}),e.jsx(ne,{}),e.jsx(ce,{})]})]}),e.jsx(X,{})]})}function he(){"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./service-worker.js").catch(()=>{})})}he();p.createRoot(document.getElementById("root")).render(e.jsx(S.StrictMode,{children:e.jsx(me,{})}));
//# sourceMappingURL=index-UiOg7ASD.js.map
