var Ne=Object.defineProperty,be=Object.defineProperties;var ke=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var re=(s,t,n)=>t in s?Ne(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n,D=(s,t)=>{for(var n in t||(t={}))ie.call(t,n)&&re(s,n,t[n]);if(H)for(var n of H(t))oe.call(t,n)&&re(s,n,t[n]);return s},L=(s,t)=>be(s,ke(t));var G=(s,t)=>{var n={};for(var r in s)ie.call(s,r)&&t.indexOf(r)<0&&(n[r]=s[r]);if(s!=null&&H)for(var r of H(s))t.indexOf(r)<0&&oe.call(s,r)&&(n[r]=s[r]);return n};var P=(s,t,n)=>new Promise((r,a)=>{var o=g=>{try{f(n.next(g))}catch(u){a(u)}},h=g=>{try{f(n.throw(g))}catch(u){a(u)}},f=g=>g.done?r(g.value):Promise.resolve(g.value).then(o,h);f((n=n.apply(s,t)).next())});import{r as d,m as E,A as le,R as Se}from"./animation-DQiad3Xl.js";import{r as Me,c as me,R as Ce,L as Ee,X as Pe,Y as Ae,T as Ie,a as Re}from"./charts-Bl1ftzsE.js";import{a as Y}from"./vendor-T6nY3V_4.js";import{L as pe,M as Te,T as De,a as ze,P as Le,u as $e}from"./maps-joNbPdQe.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();var fe={exports:{}},U={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qe=d,Oe=Symbol.for("react.element"),Fe=Symbol.for("react.fragment"),He=Object.prototype.hasOwnProperty,We=qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_e={key:!0,ref:!0,__self:!0,__source:!0};function ge(s,t,n){var r,a={},o=null,h=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(h=t.ref);for(r in t)He.call(t,r)&&!_e.hasOwnProperty(r)&&(a[r]=t[r]);if(s&&s.defaultProps)for(r in t=s.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:Oe,type:s,key:o,ref:h,props:a,_owner:We.current}}U.Fragment=Fe;U.jsx=ge;U.jsxs=ge;fe.exports=U;var e=fe.exports,J={},ce=Me;J.createRoot=ce.createRoot,J.hydrateRoot=ce.hydrateRoot;/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ue={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),S=(s,t)=>{const n=d.forwardRef((p,i)=>{var l=p,{color:r="currentColor",size:a=24,strokeWidth:o=2,absoluteStrokeWidth:h,className:f="",children:g}=l,u=G(l,["color","size","strokeWidth","absoluteStrokeWidth","className","children"]);return d.createElement("svg",D(L(D({ref:i},Ue),{width:a,height:a,stroke:r,strokeWidth:h?Number(o)*24/Number(a):o,className:["lucide",`lucide-${Ke(s)}`,f].join(" ")}),u),[...t.map(([c,x])=>d.createElement(c,x)),...Array.isArray(g)?g:[g]])});return n.displayName=`${s}`,n};/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=S("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=S("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=S("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=S("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=S("CloudRain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=S("CloudSun",[["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}],["path",{d:"M15.947 12.65a4 4 0 0 0-5.925-4.128",key:"dpwdj0"}],["path",{d:"M13 22H7a5 5 0 1 1 4.9-6H13a3 3 0 0 1 0 6Z",key:"s09mg5"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=S("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=S("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=S("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=S("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=S("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=S("Sunrise",[["path",{d:"M12 2v8",key:"1q4o3n"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=S("Sunset",[["path",{d:"M12 10V2",key:"16sf7g"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m16 6-4 4-4-4",key:"6wukr"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=S("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=S("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function tt({onToggleTheme:s,theme:t}){return e.jsx("header",{className:"header safe-area-top",children:e.jsxs("div",{className:"container header-inner",children:[e.jsxs("div",{className:"brand",children:[e.jsx("span",{className:"brand-icon","aria-hidden":"true",children:e.jsx(Ze,{size:22})}),e.jsx("span",{className:"brand-title",children:"AtmosVibe"})]}),e.jsx("button",{type:"button",className:"glass-button",onClick:s,children:t==="light"?"–¢—ë–º–Ω–∞—è —Ç–µ–º–∞":"–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞"})]})})}function st(){return e.jsx("footer",{className:"footer safe-area-bottom",children:e.jsxs("div",{className:"container footer-inner",children:[e.jsx("span",{children:"AtmosVibe Weather"}),e.jsx("span",{className:"muted",children:"PWA ‚Ä¢ Vite ‚Ä¢ React"})]})})}function C({className:s,children:t}){return e.jsx("div",{className:me("glass-card",s),children:t})}function at(r){var a=r,{className:s,children:t}=a,n=G(a,["className","children"]);return e.jsx(E.button,L(D({whileHover:{y:-1},whileTap:{y:0},transition:{duration:.15},className:me("glass-button",s)},n),{children:t}))}const xe="atmosvibe-cache:";function $(s){try{const t=window.localStorage.getItem(xe+s);return t?JSON.parse(t):null}catch(t){return null}}function Q(s,t){try{window.localStorage.setItem(xe+s,JSON.stringify(t))}catch(n){}}const ee="//api.openweathermap.org/data/2.5",te=30*60*1e3;function nt(n){return P(this,arguments,function*(s,t={}){var p,l,c,x,k,j,y,v,w;const{force:r=!1,city:a}=t,o="a55bf005791cbcd4b9066e2c59444adc",h=(a==null?void 0:a.name)||"Moscow",f=`current:${h}`;if(console.log("Weather API request:",{cityName:h,hasApiKey:!0}),!r){const N=$(f);if((N==null?void 0:N.data)!=null&&(N!=null&&N.ts)&&Date.now()-N.ts<te)return N.data}const g=$(f),{data:u}=yield Y.get(`${ee}/weather`,{params:{q:h,APPID:o,units:"metric"},timeout:1e4}).catch(N=>{var A,R,I;if(N.code==="ECONNABORTED")throw new Error("Timeout: Weather API request took too long");if(((A=N.response)==null?void 0:A.status)===401)throw new Error("Invalid API key");if(((R=N.response)==null?void 0:R.status)===404)throw new Error("City not found");if(((I=N.response)==null?void 0:I.status)===429){if(g!=null&&g.data)return console.warn("API rate limit exceeded, using cached data"),L(D({},g.data),{isRateLimited:!0});throw new Error("Too many requests. Please wait before refreshing.")}throw new Error(`Weather API error: ${N.message}`)}),i={locationName:(p=u==null?void 0:u.name)!=null?p:h,tempC:typeof((l=u==null?void 0:u.main)==null?void 0:l.temp)=="number"?u.main.temp:0,feelsLikeC:typeof((c=u==null?void 0:u.main)==null?void 0:c.feels_like)=="number"?u.main.feels_like:0,humidity:typeof((x=u==null?void 0:u.main)==null?void 0:x.humidity)=="number"?u.main.humidity:0,pressureHpa:typeof((k=u==null?void 0:u.main)==null?void 0:k.pressure)=="number"?u.main.pressure:0,windMs:typeof((j=u==null?void 0:u.wind)==null?void 0:j.speed)=="number"?u.wind.speed:0,condition:(w=(v=(y=u==null?void 0:u.weather)==null?void 0:y[0])==null?void 0:v.description)!=null?w:"‚Äî"};return console.log("Weather API result:",i),Q(f,{data:i,ts:Date.now()}),i})}function rt(n){return P(this,arguments,function*(s,t={}){var l;const{force:r=!1,city:a}=t,o="a55bf005791cbcd4b9066e2c59444adc",h=(a==null?void 0:a.name)||"Moscow",f=`forecast:${h}`;if(!r){const c=$(f);if((c==null?void 0:c.data)!=null&&(c!=null&&c.ts)&&Date.now()-c.ts<te)return c.data}const g=$(f),{data:u}=yield Y.get(`${ee}/forecast`,{params:{q:h,APPID:o,units:"metric"},timeout:1e4}).catch(c=>{var x,k,j;if(c.code==="ECONNABORTED")throw new Error("Timeout: Forecast API request took too long");if(((x=c.response)==null?void 0:x.status)===401)throw new Error("Invalid API key");if(((k=c.response)==null?void 0:k.status)===404)throw new Error("City not found");if(((j=c.response)==null?void 0:j.status)===429){if(g!=null&&g.data)return console.warn("Forecast API rate limit exceeded, using cached data"),g.data.map(y=>L(D({},y),{isRateLimited:!0}));throw new Error("Too many requests. Please wait before refreshing.")}throw new Error(`Forecast API error: ${c.message}`)}),p=((l=u==null?void 0:u.list)!=null?l:[]).slice(0,16).map(c=>{var w;const x=new Date(c.dt*1e3),k=x.getHours(),j=x.getMinutes(),y=`${String(k).padStart(2,"0")}:${String(j).padStart(2,"0")}`,v=typeof((w=c.main)==null?void 0:w.temp)=="number"?Math.round(c.main.temp):0;return{t:y,v}});return Q(f,{data:p,ts:Date.now()}),p})}function it(n){return P(this,arguments,function*(s,t={}){var l;const{force:r=!1,city:a}=t,o="a55bf005791cbcd4b9066e2c59444adc",h=(a==null?void 0:a.name)||"Moscow",f=`detailed:${h}`;if(!r){const c=$(f);if((c==null?void 0:c.data)!=null&&(c!=null&&c.ts)&&Date.now()-c.ts<te)return c.data}const g=$(f),{data:u}=yield Y.get(`${ee}/forecast`,{params:{q:h,APPID:o,units:"metric"},timeout:1e4}).catch(c=>{var x,k,j;if(c.code==="ECONNABORTED")throw new Error("Timeout: Detailed forecast API request took too long");if(((x=c.response)==null?void 0:x.status)===401)throw new Error("Invalid API key");if(((k=c.response)==null?void 0:k.status)===404)throw new Error("City not found");if(((j=c.response)==null?void 0:j.status)===429){if(g!=null&&g.data)return console.warn("Detailed forecast API rate limit exceeded, using cached data"),g.data.map(y=>L(D({},y),{isRateLimited:!0}));throw new Error("Too many requests. Please wait before refreshing.")}throw new Error(`Detailed forecast API error: ${c.message}`)}),p=((l=u==null?void 0:u.list)!=null?l:[]).slice(0,8).map(c=>{var x,k,j,y,v,w,N;return{dt:c.dt,temp:typeof((x=c.main)==null?void 0:x.temp)=="number"?Math.round(c.main.temp):0,condition:(y=(j=(k=c==null?void 0:c.weather)==null?void 0:k[0])==null?void 0:j.description)!=null?y:"‚Äî",humidity:typeof((v=c.main)==null?void 0:v.humidity)=="number"?c.main.humidity:0,windMs:typeof((w=c.wind)==null?void 0:w.speed)=="number"?c.wind.speed:0,pressure:typeof((N=c.main)==null?void 0:N.pressure)=="number"?c.main.pressure:0}});return Q(f,{data:p,ts:Date.now()}),p})}function se(){const[s,t]=d.useState(null),[n,r]=d.useState(null);return d.useEffect(()=>{if(!("geolocation"in navigator)){r(new Error("Geolocation unsupported"));return}const a=navigator.geolocation.watchPosition(o=>{const h={lat:o.coords.latitude,lon:o.coords.longitude};console.log("Geolocation coords:",h),t(h),r(null)},o=>{console.warn("Geolocation error:",o),r(o)},{enableHighAccuracy:!0,maximumAge:6e4,timeout:1e4});return()=>navigator.geolocation.clearWatch(a)},[]),{coords:s,error:n}}function ot(s){se();const[t,n]=d.useState(null),[r,a]=d.useState(!0),[o,h]=d.useState(null);console.log("useWeatherData: city prop:",s);const f=d.useCallback((u=!1)=>P(this,null,function*(){console.log("useWeatherData: run called with city:",s,"force:",u),a(!0),h(null);try{const i=yield nt(null,{force:u,city:s||null});console.log("useWeatherData: got result:",i),n(i)}catch(i){console.log("useWeatherData: error:",i),h(i)}finally{a(!1)}}),[s]);d.useEffect(()=>{f(!1)},[f]);const g=d.useCallback(()=>f(!0),[f]);return{data:t,loading:r,error:o,refetch:g}}function X(s){return typeof s!="number"||Number.isNaN(s)?"‚Äî":`${Math.round(s)}¬∞C`}function lt(s){if(!(s instanceof Date)||Number.isNaN(s.getTime()))return"‚Äî";const t=s.getHours(),n=s.getMinutes();return`${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}`}function ct({city:s}){const{data:t,loading:n,error:r,refetch:a}=ot(s);return e.jsxs(C,{className:"widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx("h3",{className:"widget-title",children:"–°–µ–π—á–∞—Å"}),e.jsxs("div",{className:"widget-header-actions",children:[e.jsxs("span",{className:"muted",children:["–õ–æ–∫–∞—Ü–∏—è: ",(t==null?void 0:t.locationName)||"‚Äî"]}),e.jsx(at,{type:"button",onClick:a,disabled:n,title:"–û–±–Ω–æ–≤–∏—Ç—å",children:r?"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å":"–û–±–Ω–æ–≤–∏—Ç—å"})]})]}),n&&e.jsx("div",{className:"skeleton widget-skeleton"}),!n&&r&&e.jsx("p",{className:"muted",children:"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–≥–æ–¥—É. –ü—Ä–æ–≤–µ—Ä—å API –∫–ª—é—á."}),!n&&!r&&t&&e.jsxs("div",{className:"current",children:[e.jsx("div",{className:"current-temp",children:X(t.tempC)}),e.jsx("div",{className:"muted",children:t.condition}),t.feelsLikeC!=null&&e.jsxs("div",{className:"muted",children:["–û—â—É—â–∞–µ—Ç—Å—è: ",X(t.feelsLikeC)]}),e.jsxs("div",{className:"current-meta",children:[e.jsxs("div",{children:[e.jsx("span",{className:"muted",children:"–í–ª–∞–∂–Ω–æ—Å—Ç—å"}),e.jsxs("div",{children:[t.humidity,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"muted",children:"–í–µ—Ç–µ—Ä"}),e.jsxs("div",{children:[t.windMs," –º/—Å"]})]}),t.pressureHpa!=null&&t.pressureHpa>0&&e.jsxs("div",{children:[e.jsx("span",{className:"muted",children:"–î–∞–≤–ª–µ–Ω–∏–µ"}),e.jsxs("div",{children:[t.pressureHpa," hPa"]})]})]})]})]})}function dt(s){se();const[t,n]=d.useState(null),[r,a]=d.useState(!0),[o,h]=d.useState(null),f=d.useCallback((u=!1)=>P(this,null,function*(){a(!0),h(null);try{const i=yield rt(null,{force:u,city:s||null});n(i)}catch(i){h(i)}finally{a(!1)}}),[s]);d.useEffect(()=>{f(!1)},[f]);const g=d.useCallback(()=>f(!0),[f]);return{data:t,loading:r,error:o,refetch:g}}const ut=[{t:"00:00",v:5},{t:"06:00",v:6},{t:"12:00",v:10},{t:"18:00",v:7}];function ht({city:s}){const{data:t,loading:n,error:r}=dt(s),a=t!=null&&t.length?t:ut;return e.jsxs(C,{className:"widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx("h3",{className:"widget-title",children:"–ü—Ä–æ–≥–Ω–æ–∑"}),e.jsx("span",{className:"muted",children:"–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, 3 —á"})]}),n&&e.jsx("div",{className:"skeleton widget-skeleton"}),!n&&r&&e.jsx("p",{className:"muted",children:"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑."}),!n&&!r&&a.length>0&&e.jsx("div",{style:{width:"100%",height:240},children:e.jsx(Ce,{children:e.jsxs(Ee,{data:a,children:[e.jsx(Pe,{dataKey:"t",stroke:"rgba(255,255,255,0.6)",fontSize:12}),e.jsx(Ae,{stroke:"rgba(255,255,255,0.6)",fontSize:12}),e.jsx(Ie,{contentStyle:{background:"rgba(15, 23, 42, 0.85)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:12},labelStyle:{color:"#f8fafc"},formatter:o=>[`${o} ¬∞C`,"–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞"]}),e.jsx(Re,{type:"monotone",dataKey:"v",stroke:"#8b5cf6",strokeWidth:2,dot:!1})]})})})]})}delete pe.Icon.Default.prototype._getIconUrl;pe.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"});const mt=[55.751244,37.618423],pt=10;function ft({center:s}){const t=$e();return d.useEffect(()=>{s&&s[0]!=null&&s[1]!=null&&t.setView(s,t.getZoom())},[t,s]),null}function gt({city:s}){const t=s?[s.lat,s.lon]:mt,n=!!s;return e.jsxs(C,{className:"widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx("h3",{className:"widget-title",children:"–ö–∞—Ä—Ç–∞"}),e.jsx("span",{className:"muted",children:n?s.name:"–¶–µ–Ω—Ç—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é"})]}),e.jsx("div",{className:"map-container",children:e.jsxs(Te,{center:t,zoom:pt,scrollWheelZoom:!0,style:{height:"100%",width:"100%"},children:[e.jsx(De,{attribution:'¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e.jsx(ft,{center:t}),n&&e.jsx(ze,{position:[s.lat,s.lon],children:e.jsxs(Le,{children:["–ü–æ–≥–æ–¥–∞ –≤ ",s.name]})})]})})]})}function xt(s){se();const[t,n]=d.useState(null),[r,a]=d.useState(!0),[o,h]=d.useState(null),f=d.useCallback((u=!1)=>P(this,null,function*(){a(!0),h(null);try{const i=yield it(null,{force:u,city:s||null});n(i)}catch(i){h(i)}finally{a(!1)}}),[s]);d.useEffect(()=>{f(!1)},[f]);const g=d.useCallback(()=>f(!0),[f]);return{data:t,loading:r,error:o,refetch:g}}function jt({city:s}){const{data:t,loading:n,error:r}=xt(s);return e.jsxs(C,{className:"widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx("h3",{className:"widget-title",children:"–ü–æ–¥—Ä–æ–±–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑"}),e.jsx("span",{className:"muted",children:"–ù–∞ –±–ª–∏–∂–∞–π—à–∏–µ 24 —á–∞—Å–∞"})]}),n&&e.jsx("div",{className:"skeleton widget-skeleton"}),!n&&r&&e.jsx("p",{className:"muted",children:"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑."}),!n&&!r&&t&&t.length>0&&e.jsx("div",{className:"detailed-forecast",children:e.jsx("div",{className:"forecast-list",children:t.map((a,o)=>e.jsxs("div",{className:"forecast-item",children:[e.jsx("div",{className:"forecast-time",children:lt(new Date(a.dt*1e3))}),e.jsx("div",{className:"forecast-temp",children:X(a.temp)}),e.jsx("div",{className:"forecast-condition",children:a.condition}),e.jsxs("div",{className:"forecast-details",children:[e.jsxs("span",{className:"forecast-humidity",children:["üíß ",a.humidity,"%"]}),e.jsxs("span",{className:"forecast-wind",children:["üí® ",a.windMs," –º/—Å"]})]})]},o))})})]})}const Z=[{name:"–ú–æ—Å–∫–≤–∞",country:"RU",lat:55.7558,lon:37.6173},{name:"–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",country:"RU",lat:59.9343,lon:30.3351},{name:"–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫",country:"RU",lat:55.0084,lon:82.9357},{name:"–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥",country:"RU",lat:56.8389,lon:60.6057},{name:"–ö–∞–∑–∞–Ω—å",country:"RU",lat:55.8304,lon:49.0661},{name:"London",country:"GB",lat:51.5074,lon:-.1278},{name:"Paris",country:"FR",lat:48.8566,lon:2.3522},{name:"New York",country:"US",lat:40.7128,lon:-74.006},{name:"Tokyo",country:"JP",lat:35.6762,lon:139.6503},{name:"Berlin",country:"DE",lat:52.52,lon:13.405}];function yt({onCitySelect:s,currentCity:t}){const[n,r]=d.useState(""),[a,o]=d.useState([]),[h,f]=d.useState(!1),[g,u]=d.useState(!1),[i,p]=d.useState([]),[l,c]=d.useState(!1),[x,k]=d.useState({top:0,left:0,width:0}),j=d.useRef(null),y=d.useRef(null),v=d.useRef(null);d.useEffect(()=>{try{const m=localStorage.getItem("favorite-cities");m&&p(JSON.parse(m))}catch(m){p([])}},[]);const w=d.useCallback(()=>{if(j.current&&h){const m=j.current.getBoundingClientRect();k({top:m.bottom+window.scrollY+8,left:m.left+window.scrollX,width:m.width})}},[h]);d.useEffect(()=>{if(h)return w(),window.addEventListener("scroll",w),window.addEventListener("resize",w),()=>{window.removeEventListener("scroll",w),window.removeEventListener("resize",w)}},[h,w]);const[N,A]=d.useState(0);d.useEffect(()=>{h&&A(m=>m+1)},[h]),d.useEffect(()=>{g&&!n?f(!0):!g&&!n&&document.activeElement!==j.current&&f(!1)},[g,n]);const R=()=>{u(!0)},I=()=>{u(!1)},K=m=>{try{localStorage.setItem("favorite-cities",JSON.stringify(m)),p(m)}catch(b){}};d.useEffect(()=>{const m=b=>{y.current&&!y.current.contains(b.target)&&f(!1)};return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[]);const F=m=>P(this,null,function*(){if(console.log("CitySearch: searchCities called with:",m),!m.trim()){console.log("CitySearch: empty query, showing popular cities"),o(Z.slice(0,5));return}c(!0);try{const b="a55bf005791cbcd4b9066e2c59444adc";console.log("CitySearch: API key exists:",!!b);const z=yield(yield fetch(`//api.openweathermap.org/geo/1.0/direct?q=${encodeURIComponent(m)}&limit=5&appid=${b}`)).json();console.log("CitySearch: API response:",z);const T=z.map(q=>({name:q.name,country:q.country,lat:q.lat,lon:q.lon,state:q.state}));console.log("CitySearch: processed cities:",T),o(T)}catch(b){console.error("CitySearch: Error searching cities:",b);const M=Z.filter(z=>z.name.toLowerCase().includes(m.toLowerCase()));o(M.slice(0,5))}finally{c(!1)}});d.useEffect(()=>{const m=setTimeout(()=>{n?F(n):o(Z.slice(0,5))},300);return()=>clearTimeout(m)},[n]);const je=m=>{const b=m.target.value;console.log("CitySearch: input changed to:",b),r(b),f(!0),console.log("CitySearch: setIsOpen called with true")},ae=m=>{console.log("CitySearch: handleCitySelect called with:",m),console.log("CitySearch: onCitySelect exists:",!!s),r(m.name),f(!1),s?(console.log("CitySearch: calling onCitySelect"),s(m)):console.log("CitySearch: onCitySelect is undefined")},ye=()=>{var m;r(""),f(!1),(m=j.current)==null||m.focus()},ve=()=>{console.log("CitySearch: input focused"),f(!0)},we=()=>{setTimeout(()=>{var m;!g&&!((m=y.current)!=null&&m.contains(document.activeElement))&&f(!1)},100)},ne=(m,b)=>{b.stopPropagation();const M=`${m.name},${m.country}`,z=i.some(T=>`${T.name},${T.country}`===M)?i.filter(T=>`${T.name},${T.country}`!==M):[...i,m];K(z)},B=m=>{const b=`${m.name},${m.country}`;return i.some(M=>`${M.name},${M.country}`===b)};return e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"city-search",children:e.jsx("div",{ref:v,className:"search-container",onMouseEnter:R,onMouseLeave:I,children:e.jsxs(E.div,{className:"search-input-wrapper",whileFocus:{scale:1.02},transition:{duration:.2},children:[e.jsx(E.div,{className:"search-icon",animate:{rotate:h?360:0},transition:{duration:.3},children:e.jsx(Ve,{size:18})}),e.jsx("input",{ref:j,type:"text",value:n,onChange:je,onFocus:ve,onBlur:we,placeholder:"–ü–æ–∏—Å–∫ –≥–æ—Ä–æ–¥–∞...",className:"search-input"}),e.jsx(le,{children:n&&e.jsx(E.button,{onClick:ye,className:"clear-button",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},transition:{duration:.2},whileHover:{scale:1.1,rotate:90},whileTap:{scale:.9},children:e.jsx(et,{size:16})})})]})})}),e.jsx(le,{children:h&&e.jsx(E.div,{ref:y,className:"search-dropdown",style:{position:"fixed",top:`${x.top}px`,left:`${x.left}px`,width:`${x.width}px`,background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.3)",zIndex:99999},initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.2,ease:[.4,0,.2,1]},onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:l?e.jsx(E.div,{className:"search-loading",initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},children:"–ó–∞–≥—Ä—É–∑–∫–∞..."}):e.jsxs(e.Fragment,{children:[i.length>0&&e.jsxs(E.div,{className:"search-section",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},children:[e.jsx("div",{className:"search-section-title",children:"–ò–∑–±—Ä–∞–Ω–Ω–æ–µ"}),i.map((m,b)=>e.jsxs(E.div,{className:"search-item favorite",onClick:()=>ae(m),initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1+b*.05},whileHover:{scale:1.02,x:5},whileTap:{scale:.98},children:[e.jsx(V,{size:16}),e.jsxs("div",{className:"search-item-info",children:[e.jsx("div",{className:"search-item-name",children:m.name}),e.jsx("div",{className:"search-item-country",children:m.country})]}),e.jsx(E.button,{onClick:M=>{M.stopPropagation(),ne(m,M)},className:"favorite-button active",whileHover:{scale:1.2,rotate:72},whileTap:{scale:.9},children:e.jsx(ue,{size:16,fill:"currentColor"})})]},`fav-${b}-${N}`))]}),e.jsxs(E.div,{className:"search-section",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},children:[e.jsx("div",{className:"search-section-title",children:n?"–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞":"–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –≥–æ—Ä–æ–¥–∞"}),a.map((m,b)=>e.jsxs(E.div,{className:"search-item",onClick:()=>{console.log("CitySearch: clicked on city:",m),ae(m)},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2+b*.05},whileHover:{scale:1.02,x:5},whileTap:{scale:.98},children:[e.jsx(V,{size:16}),e.jsxs("div",{className:"search-item-info",children:[e.jsx("div",{className:"search-item-name",children:m.name}),e.jsxs("div",{className:"search-item-country",children:[m.state?`${m.state}, `:"",m.country]})]}),e.jsx(E.button,{onClick:M=>{M.stopPropagation(),ne(m,M)},className:`favorite-button ${B(m)?"active":""}`,whileHover:{scale:1.2,rotate:B(m)?72:0},whileTap:{scale:.9},children:e.jsx(ue,{size:16,fill:B(m)?"currentColor":"none"})})]},`sug-${b}-${N}`))]})]})},`dropdown-${N}`)})]})}function vt({weather:s="clear"}){const t=d.useRef(null);d.useRef(null);const n=d.useRef([]);return d.useEffect(()=>{const r=t.current;if(!r)return;const a=r.getContext("2d");let o;const h=()=>{r.width=window.innerWidth,r.height=window.innerHeight};h(),window.addEventListener("resize",h);const f=()=>{switch(s){case"rain":return{count:100,speed:{min:5,max:10},size:{min:1,max:3},opacity:{min:.3,max:.8},color:"rgba(174, 194, 224, 0.6)"};case"snow":return{count:80,speed:{min:1,max:3},size:{min:2,max:6},opacity:{min:.4,max:.9},color:"rgba(255, 255, 255, 0.8)"};case"cloudy":return{count:20,speed:{min:.2,max:.8},size:{min:30,max:80},opacity:{min:.1,max:.3},color:"rgba(255, 255, 255, 0.4)"};default:return{count:30,speed:{min:.1,max:.5},size:{min:20,max:60},opacity:{min:.05,max:.15},color:"rgba(255, 255, 255, 0.3)"}}};class g{constructor(l){this.reset(l)}reset(l){this.x=Math.random()*r.width,this.y=Math.random()*r.height-r.height,this.size=Math.random()*(l.size.max-l.size.min)+l.size.min,this.speed=Math.random()*(l.speed.max-l.speed.min)+l.speed.min,this.opacity=Math.random()*(l.opacity.max-l.opacity.min)+l.opacity.min,this.color=l.color,this.angle=Math.random()*Math.PI*2,this.angleSpeed=(Math.random()-.5)*.02}update(l){s==="rain"?(this.y+=this.speed,this.x+=Math.sin(this.angle)*.5,this.angle+=this.angleSpeed):s==="snow"?(this.y+=this.speed,this.x+=Math.sin(this.angle)*2,this.angle+=this.angleSpeed):(this.y+=this.speed*.3,this.x+=Math.sin(this.angle)*.5,this.angle+=this.angleSpeed*.5),this.y>r.height+50&&(this.y=-50,this.x=Math.random()*r.width),this.x>r.width+50&&(this.x=-50),this.x<-50&&(this.x=r.width+50)}draw(l){if(l.save(),l.globalAlpha=this.opacity,l.fillStyle=this.color,s==="rain")l.beginPath(),l.moveTo(this.x,this.y),l.lineTo(this.x,this.y+this.size*3),l.strokeStyle=this.color,l.lineWidth=this.size,l.stroke();else if(s==="snow"){l.beginPath(),l.arc(this.x,this.y,this.size,0,Math.PI*2),l.fill(),l.strokeStyle=this.color,l.lineWidth=1;for(let c=0;c<6;c++){const x=Math.PI*2/6*c;l.beginPath(),l.moveTo(this.x,this.y),l.lineTo(this.x+Math.cos(x)*this.size*2,this.y+Math.sin(x)*this.size*2),l.stroke()}}else l.beginPath(),l.arc(this.x,this.y,this.size,0,Math.PI*2),l.fill();l.restore()}}const u=f();n.current=Array.from({length:u.count},()=>new g(u));const i=()=>{a.clearRect(0,0,r.width,r.height),n.current.forEach(p=>{p.update(u),p.draw(a)}),o=requestAnimationFrame(i)};return i(),()=>{cancelAnimationFrame(o),window.removeEventListener("resize",h)}},[s]),e.jsx("canvas",{ref:t,className:"weather-background",style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:1}})}function wt({city:s}){const[t,n]=d.useState(null),[r,a]=d.useState(!0);d.useEffect(()=>{s&&P(this,null,function*(){a(!0),yield new Promise(i=>setTimeout(i,1e3));const u={aqi:Math.floor(Math.random()*150)+20,pm25:Math.random()*50+10,pm10:Math.random()*80+20,o3:Math.random()*100+40,no2:Math.random()*60+10,so2:Math.random()*20+5,co:Math.random()*2+.5};n(u),a(!1)})},[s]);const o=g=>g<=50?{level:"–•–æ—Ä–æ—à–µ–µ",color:"#10b981",icon:Ge}:g<=100?{level:"–£–º–µ—Ä–µ–Ω–Ω–æ–µ",color:"#f59e0b",icon:_}:g<=150?{level:"–í—Ä–µ–¥–Ω–æ–µ –¥–ª—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –≥—Ä—É–ø–ø",color:"#f97316",icon:O}:g<=200?{level:"–ù–µ–∑–¥–æ—Ä–æ–≤–æ–µ",color:"#ef4444",icon:O}:g<=300?{level:"–û—á–µ–Ω—å –Ω–µ–∑–¥–æ—Ä–æ–≤–æ–µ",color:"#7c3aed",icon:O}:{level:"–û–ø–∞—Å–Ω–æ–µ",color:"#991b1b",icon:O};if(r)return e.jsxs(C,{className:"air-quality-widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx(_,{size:20}),e.jsx("h3",{children:"–ö–∞—á–µ—Å—Ç–≤–æ –≤–æ–∑–¥—É—Ö–∞"})]}),e.jsxs("div",{className:"loading-content",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."})]})]});if(!t)return e.jsxs(C,{className:"air-quality-widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx(_,{size:20}),e.jsx("h3",{children:"–ö–∞—á–µ—Å—Ç–≤–æ –≤–æ–∑–¥—É—Ö–∞"})]}),e.jsxs("div",{className:"error-content",children:[e.jsx(O,{size:24}),e.jsx("p",{children:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö"})]})]});const h=o(t.aqi),f=h.icon;return e.jsxs(C,{className:"air-quality-widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx(_,{size:20}),e.jsx("h3",{children:"–ö–∞—á–µ—Å—Ç–≤–æ –≤–æ–∑–¥—É—Ö–∞"})]}),e.jsxs("div",{className:"air-quality-content",children:[e.jsxs("div",{className:"aqi-main",children:[e.jsx("div",{className:"aqi-value",style:{color:h.color},children:t.aqi}),e.jsxs("div",{className:"aqi-level",children:[e.jsx(f,{size:16,style:{color:h.color}}),e.jsx("span",{style:{color:h.color},children:h.level})]})]}),e.jsxs("div",{className:"pollutants-grid",children:[e.jsxs("div",{className:"pollutant-item",children:[e.jsx("div",{className:"pollutant-name",children:"PM2.5"}),e.jsx("div",{className:"pollutant-value",children:t.pm25.toFixed(1)})]}),e.jsxs("div",{className:"pollutant-item",children:[e.jsx("div",{className:"pollutant-name",children:"PM10"}),e.jsx("div",{className:"pollutant-value",children:t.pm10.toFixed(1)})]}),e.jsxs("div",{className:"pollutant-item",children:[e.jsx("div",{className:"pollutant-name",children:"O‚ÇÉ"}),e.jsx("div",{className:"pollutant-value",children:t.o3.toFixed(1)})]}),e.jsxs("div",{className:"pollutant-item",children:[e.jsx("div",{className:"pollutant-name",children:"NO‚ÇÇ"}),e.jsx("div",{className:"pollutant-value",children:t.no2.toFixed(1)})]})]}),e.jsxs("div",{className:"air-quality-tips",children:[e.jsx("h4",{children:"–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:"}),t.aqi<=50&&e.jsx("p",{children:"–û—Ç–ª–∏—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –ø—Ä–æ–≥—É–ª–æ–∫ –∏ –∑–∞–Ω—è—Ç–∏–π —Å–ø–æ—Ä—Ç–æ–º –Ω–∞ —Å–≤–µ–∂–µ–º –≤–æ–∑–¥—É—Ö–µ."}),t.aqi>50&&t.aqi<=100&&e.jsx("p",{children:"–ü—Ä–∏–µ–º–ª–µ–º–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤–æ–∑–¥—É—Ö–∞. –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –ª—é–¥—è–º —Å–ª–µ–¥—É–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≥—É–ª–∫–∏."}),t.aqi>100&&t.aqi<=150&&e.jsx("p",{children:"–õ—é–¥—è–º —Å —Ä–µ—Å–ø–∏—Ä–∞—Ç–æ—Ä–Ω—ã–º–∏ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º–∏ —Å–ª–µ–¥—É–µ—Ç –∏–∑–±–µ–≥–∞—Ç—å —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫ –Ω–∞ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–æ–∑–¥—É—Ö–µ."}),t.aqi>150&&e.jsx("p",{children:"–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –≤ –ø–æ–º–µ—â–µ–Ω–∏–∏. –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ –Ω–∞ —É–ª–∏—Ü—É –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞—â–∏—Ç–Ω—É—é –º–∞—Å–∫—É."})]})]})]})}function Nt({city:s}){const t=d.useRef(null),[n,r]=d.useState(!0),[a,o]=d.useState(null),h=d.useRef(null);d.useEffect(()=>{s&&P(this,null,function*(){r(!0),yield new Promise(l=>setTimeout(l,1500));const p={center:{lat:(s==null?void 0:s.lat)||55.7558,lon:(s==null?void 0:s.lon)||37.6173},precipitation:f(),timestamp:new Date().toISOString()};o(p),r(!1)})},[s]);const f=()=>{const i=[];for(let p=0;p<50;p++)i.push({x:Math.random()*300-150,y:Math.random()*300-150,intensity:Math.random(),type:Math.random()>.7?"rain":Math.random()>.9?"storm":"cloud",size:Math.random()*30+10,speed:Math.random()*2+.5,direction:Math.random()*Math.PI*2});return i};d.useEffect(()=>{if(!a||!t.current)return;const i=t.current,p=i.getContext("2d");i.width=300,i.height=300;let l=0;const c=()=>{p.clearRect(0,0,i.width,i.height),g(p,i.width,i.height),a.precipitation.forEach((x,k)=>{const j=i.width/2+x.x+Math.cos(x.direction)*l*x.speed,y=i.height/2+x.y+Math.sin(x.direction)*l*x.speed;let v;x.type==="storm"?v=`rgba(147, 51, 234, ${x.intensity*.8})`:x.type==="rain"?v=`rgba(59, 130, 246, ${x.intensity*.6})`:v=`rgba(156, 163, 175, ${x.intensity*.3})`,p.save(),p.globalAlpha=x.intensity*.7,p.fillStyle=v;const w=p.createRadialGradient(j,y,0,j,y,x.size);w.addColorStop(0,v),w.addColorStop(1,"transparent"),p.fillStyle=w,p.beginPath(),p.arc(j,y,x.size,0,Math.PI*2),p.fill(),p.restore()}),u(p,i.width/2,i.height/2),l+=.1,h.current=requestAnimationFrame(c)};return c(),()=>{h.current&&cancelAnimationFrame(h.current)}},[a]);const g=(i,p,l)=>{i.strokeStyle="rgba(255, 255, 255, 0.1)",i.lineWidth=1;for(let c=1;c<=4;c++)i.beginPath(),i.arc(p/2,l/2,p/2*(c/4),0,Math.PI*2),i.stroke();for(let c=0;c<8;c++){const x=Math.PI*2/8*c;i.beginPath(),i.moveTo(p/2,l/2),i.lineTo(p/2+Math.cos(x)*p/2,l/2+Math.sin(x)*l/2),i.stroke()}i.fillStyle="rgba(255, 255, 255, 0.6)",i.font="10px sans-serif",i.fillText("25 –∫–º",p/2+5,l/2-p/4),i.fillText("50 –∫–º",p/2+5,l/2-p/2),i.fillText("75 –∫–º",p/2+5,l/2-p*3/4)},u=(i,p,l)=>{i.fillStyle="#ef4444",i.beginPath(),i.arc(p,l,5,0,Math.PI*2),i.fill(),i.strokeStyle="#ef4444",i.lineWidth=2,i.globalAlpha=.5,i.beginPath(),i.arc(p,l,10,0,Math.PI*2),i.stroke(),i.globalAlpha=1};return n?e.jsxs(C,{className:"radar-widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx(de,{size:20}),e.jsx("h3",{children:"–†–∞–¥–∞—Ä –æ—Å–∞–¥–∫–æ–≤"})]}),e.jsxs("div",{className:"loading-content",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞–¥–∞—Ä–∞..."})]})]}):e.jsxs(C,{className:"radar-widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx(de,{size:20}),e.jsx("h3",{children:"–†–∞–¥–∞—Ä –æ—Å–∞–¥–∫–æ–≤"})]}),e.jsxs("div",{className:"radar-content",children:[e.jsx("div",{className:"radar-container",children:e.jsx("canvas",{ref:t,className:"radar-canvas",style:{width:"100%",height:"300px",borderRadius:"8px"}})}),e.jsxs("div",{className:"radar-legend",children:[e.jsx("div",{className:"legend-title",children:"–ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –æ—Å–∞–¥–∫–æ–≤"}),e.jsxs("div",{className:"legend-items",children:[e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-color",style:{background:"rgba(156, 163, 175, 0.5)"}}),e.jsx("span",{children:"–û–±–ª–∞—á–Ω–æ"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-color",style:{background:"rgba(59, 130, 246, 0.6)"}}),e.jsx("span",{children:"–î–æ–∂–¥—å"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-color",style:{background:"rgba(147, 51, 234, 0.8)"}}),e.jsx("span",{children:"–ì—Ä–æ–∑–∞"})]})]})]}),e.jsxs("div",{className:"radar-info",children:[e.jsxs("div",{className:"info-item",children:[e.jsx(V,{size:14}),e.jsx("span",{children:(s==null?void 0:s.name)||"–ú–æ—Å–∫–≤–∞"})]}),e.jsxs("div",{className:"info-item",children:[e.jsx(Be,{size:14}),e.jsxs("span",{children:["–û–±–Ω–æ–≤–ª–µ–Ω: ",new Date().toLocaleTimeString()]})]})]})]})]})}function bt({city:s}){const[t,n]=d.useState(null),[r,a]=d.useState(!0),[o,h]=d.useState(new Date);d.useEffect(()=>{s&&P(this,null,function*(){a(!0),yield new Promise(I=>setTimeout(I,800));const y=new Date,v=(s==null?void 0:s.lat)||55.7558,w=(s==null?void 0:s.lon)||37.6173,N=f(v,w,y,!0),A=f(v,w,y,!1),R=p(y);n({sunrise:N,sunset:A,moonPhase:R,daylightHours:g(N,A),currentTime:y,nextSunrise:u(N,y),nextSunset:i(A,y)}),a(!1)})},[s]),d.useEffect(()=>{const j=setInterval(()=>{h(new Date)},1e3);return()=>clearInterval(j)},[]);const f=(j,y,v,w)=>{const N=w?6:18,A=j/90*2,R=Math.sin((v.getMonth()+1)*Math.PI/6)*1.5,I=N+A+R+(Math.random()-.5)*.5,K=Math.floor(I%1*60),F=new Date(v);return F.setHours(Math.floor(I),K,0,0),F},g=(j,y)=>(y-j)/(1e3*60*60),u=(j,y)=>{const v=new Date(j);return v<=y&&v.setDate(v.getDate()+1),v},i=(j,y)=>{const v=new Date(j);return v<=y&&v.setDate(v.getDate()+1),v},p=j=>{const y=["üåë","üåí","üåì","üåî","üåï","üåñ","üåó","üåò"],v=j.getDate();return y[v%8]},l=j=>{const y=j-o,v=Math.floor(y/(1e3*60*60)),w=Math.floor(y%(1e3*60*60)/(1e3*60));return v>0?`${v}—á ${w}–º`:`${w}–º`},c=j=>j?Ye:Qe,x=()=>t?o>=t.sunrise&&o<=t.sunset:!0;if(r)return e.jsxs(C,{className:"sun-times-widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx(W,{size:20}),e.jsx("h3",{children:"–°–æ–ª–Ω—Ü–µ –∏ –ª—É–Ω–∞"})]}),e.jsxs("div",{className:"loading-content",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."})]})]});if(!t)return e.jsxs(C,{className:"sun-times-widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx(W,{size:20}),e.jsx("h3",{children:"–°–æ–ª–Ω—Ü–µ –∏ –ª—É–Ω–∞"})]}),e.jsxs("div",{className:"error-content",children:[e.jsx(W,{size:24}),e.jsx("p",{children:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö"})]})]});const k=c(!0);return e.jsxs(C,{className:"sun-times-widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx(W,{size:20}),e.jsx("h3",{children:"–°–æ–ª–Ω—Ü–µ –∏ –ª—É–Ω–∞"})]}),e.jsxs("div",{className:"sun-times-content",children:[e.jsxs("div",{className:"current-state",children:[e.jsx("div",{className:"state-icon",children:x()?e.jsxs("div",{className:"sun-icon-animated",children:[e.jsx(Xe,{size:32}),e.jsx("div",{className:"sun-rays"})]}):e.jsxs("div",{className:"moon-icon-animated",children:[e.jsx(Je,{size:32}),e.jsx("div",{className:"moon-glow"})]})}),e.jsxs("div",{className:"state-info",children:[e.jsx("div",{className:"state-label",children:x()?"–î–µ–Ω—å":"–ù–æ—á—å"}),e.jsx("div",{className:"state-time",children:o.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"sun-events",children:[e.jsxs("div",{className:"sun-event",children:[e.jsx("div",{className:"event-icon",children:e.jsx(k,{size:20})}),e.jsxs("div",{className:"event-info",children:[e.jsx("div",{className:"event-label",children:"–í–æ—Å—Ö–æ–¥"}),e.jsx("div",{className:"event-time",children:t.sunrise.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}),e.jsx("div",{className:"event-countdown",children:o<t.sunrise?`—á–µ—Ä–µ–∑ ${l(t.nextSunrise)}`:`–±—ã–ª ${l(o-t.sunrise)} –Ω–∞–∑–∞–¥`})]})]}),e.jsxs("div",{className:"sun-event",children:[e.jsx("div",{className:"event-icon",children:e.jsx(k,{size:20})}),e.jsxs("div",{className:"event-info",children:[e.jsx("div",{className:"event-label",children:"–ó–∞–∫–∞—Ç"}),e.jsx("div",{className:"event-time",children:t.sunset.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}),e.jsx("div",{className:"event-countdown",children:o<t.sunset?`—á–µ—Ä–µ–∑ ${l(t.nextSunset)}`:`–±—ã–ª ${l(o-t.sunset)} –Ω–∞–∑–∞–¥`})]})]})]}),e.jsxs("div",{className:"day-info",children:[e.jsxs("div",{className:"day-stat",children:[e.jsx("div",{className:"stat-label",children:"–°–≤–µ—Ç–æ–≤–æ–π –¥–µ–Ω—å"}),e.jsxs("div",{className:"stat-value",children:[Math.floor(t.daylightHours),"—á ",Math.floor(t.daylightHours%1*60),"–º"]})]}),e.jsxs("div",{className:"day-stat",children:[e.jsx("div",{className:"stat-label",children:"–§–∞–∑–∞ –ª—É–Ω—ã"}),e.jsx("div",{className:"stat-value",children:e.jsx("span",{className:"moon-emoji",children:t.moonPhase})})]})]}),e.jsxs("div",{className:"day-progress",children:[e.jsx("div",{className:"progress-label",children:"–ü—Ä–æ–≥—Ä–µ—Å—Å –¥–Ω—è"}),e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:`${(o-t.sunrise)/(t.sunset-t.sunrise)*100}%`,background:x()?"linear-gradient(90deg, #f59e0b, #ef4444)":"linear-gradient(90deg, #6366f1, #8b5cf6)"}})}),e.jsxs("div",{className:"progress-percentage",children:[Math.floor((o-t.sunrise)/(t.sunset-t.sunrise)*100),"%"]})]})]})]})}function kt({checked:s,onChange:t,label:n}){return e.jsxs("label",{className:"toggle",children:[e.jsx("input",{className:"toggle-input",type:"checkbox",checked:s,onChange:t}),e.jsx("span",{className:"toggle-track","aria-hidden":"true",children:e.jsx("span",{className:"toggle-thumb"})}),e.jsx("span",{className:"toggle-label",children:n})]})}const he="atmosvibe-theme";function St(){const s=d.useMemo(()=>{if(typeof window=="undefined")return"dark";const a=window.localStorage.getItem(he);return a==="light"||a==="dark"?a:window.matchMedia&&window.matchMedia("(prefers-color-scheme: light)").matches?"light":"dark"},[]),[t,n]=d.useState(s);return d.useEffect(()=>{document.documentElement.dataset.theme=t,window.localStorage.setItem(he,t)},[t]),{theme:t,toggleTheme:()=>n(a=>a==="light"?"dark":"light")}}function Mt(){const[s,t]=d.useState({name:"–ú–æ—Å–∫–≤–∞",country:"RU",lat:55.7558,lon:37.6173}),{theme:n,toggleTheme:r}=St(),a=d.useCallback(o=>{console.log("App: handleCitySelect called with:",o),t({name:o.name,country:o.country,lat:o.lat,lon:o.lon}),console.log("App: setSelectedCity called, new city:",o.name)},[]);return e.jsxs("div",{className:"app","data-theme":n,children:[e.jsx(vt,{weather:"clear"}),e.jsx("div",{className:"background"}),e.jsx(tt,{onToggleTheme:r,theme:n}),e.jsxs("main",{className:"container safe-area-top safe-area-left safe-area-right",children:[e.jsxs("div",{className:"toolbar",children:[e.jsx(yt,{onCitySelect:a,currentCity:s}),e.jsx(kt,{checked:n==="light",onChange:r,label:"Light"})]}),e.jsxs("section",{className:"grid-responsive",children:[e.jsx(ct,{city:s}),e.jsx(ht,{city:s}),e.jsx(gt,{city:s}),e.jsx(jt,{city:s}),e.jsx(wt,{city:s}),e.jsx(Nt,{city:s}),e.jsx(bt,{city:s})]})]}),e.jsx(st,{})]})}function Ct(){return e.jsx(Mt,{})}function Et(){"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./service-worker.js").catch(()=>{})})}Et();J.createRoot(document.getElementById("root")).render(e.jsx(Se.StrictMode,{children:e.jsx(Ct,{})}));
