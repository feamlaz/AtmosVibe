import{r as d,m as E,A as ee,R as pe}from"./animation-vvSlrX56.js";import{r as fe,c as re,R as ge,L as xe,X as je,Y as ye,T as ve,a as we}from"./charts-D1-koghQ.js";import{a as G}from"./vendor-D5GkNzM3.js";import{L as ie,M as Ne,T as be,a as ke,P as Se,u as Me}from"./maps-BE1myg9G.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const h of l.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function c(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(o){if(o.ep)return;o.ep=!0;const l=c(o);fetch(o.href,l)}})();var oe={exports:{}},F={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ce=d,Ee=Symbol.for("react.element"),Pe=Symbol.for("react.fragment"),Ae=Object.prototype.hasOwnProperty,Ie=Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Re={key:!0,ref:!0,__self:!0,__source:!0};function le(s,t,c){var i,o={},l=null,h=null;c!==void 0&&(l=""+c),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(h=t.ref);for(i in t)Ae.call(t,i)&&!Re.hasOwnProperty(i)&&(o[i]=t[i]);if(s&&s.defaultProps)for(i in t=s.defaultProps,t)o[i]===void 0&&(o[i]=t[i]);return{$$typeof:Ee,type:s,key:l,ref:h,props:o,_owner:Ie.current}}F.Fragment=Pe;F.jsx=le;F.jsxs=le;oe.exports=F;var e=oe.exports,U={},te=fe;U.createRoot=te.createRoot,U.hydrateRoot=te.hydrateRoot;/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Te={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),k=(s,t)=>{const c=d.forwardRef(({color:i="currentColor",size:o=24,strokeWidth:l=2,absoluteStrokeWidth:h,className:p="",children:u,...v},n)=>d.createElement("svg",{ref:n,...Te,width:o,height:o,stroke:i,strokeWidth:h?Number(l)*24/Number(o):l,className:["lucide",`lucide-${De(s)}`,p].join(" "),...v},[...t.map(([a,r])=>d.createElement(a,r)),...Array.isArray(u)?u:[u]]));return c.displayName=`${s}`,c};/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=k("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=k("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=k("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=k("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=k("CloudRain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=k("CloudSun",[["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}],["path",{d:"M15.947 12.65a4 4 0 0 0-5.925-4.128",key:"dpwdj0"}],["path",{d:"M13 22H7a5 5 0 1 1 4.9-6H13a3 3 0 0 1 0 6Z",key:"s09mg5"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=k("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=k("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=k("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=k("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=k("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=k("Sunrise",[["path",{d:"M12 2v8",key:"1q4o3n"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=k("Sunset",[["path",{d:"M12 10V2",key:"16sf7g"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m16 6-4 4-4-4",key:"6wukr"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=k("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=k("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Ue({onToggleTheme:s,theme:t}){return e.jsx("header",{className:"header safe-area-top",children:e.jsxs("div",{className:"container header-inner",children:[e.jsxs("div",{className:"brand",children:[e.jsx("span",{className:"brand-icon","aria-hidden":"true",children:e.jsx($e,{size:22})}),e.jsx("span",{className:"brand-title",children:"AtmosVibe"})]}),e.jsx("button",{type:"button",className:"glass-button",onClick:s,children:t==="light"?"–¢—ë–º–Ω–∞—è —Ç–µ–º–∞":"–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞"})]})})}function Ke(){return e.jsx("footer",{className:"footer safe-area-bottom",children:e.jsxs("div",{className:"container footer-inner",children:[e.jsx("span",{children:"AtmosVibe Weather"}),e.jsx("span",{className:"muted",children:"PWA ‚Ä¢ Vite ‚Ä¢ React"})]})})}function M({className:s,children:t}){return e.jsx("div",{className:re("glass-card",s),children:t})}function Be({className:s,children:t,...c}){return e.jsx(E.button,{whileHover:{y:-1},whileTap:{y:0},transition:{duration:.15},className:re("glass-button",s),...c,children:t})}const ce="atmosvibe-cache:";function T(s){try{const t=window.localStorage.getItem(ce+s);return t?JSON.parse(t):null}catch{return null}}function Z(s,t){try{window.localStorage.setItem(ce+s,JSON.stringify(t))}catch{}}const J="//api.openweathermap.org/data/2.5",V=30*60*1e3;async function Ge(s,t={}){var n,a,r,j,g,b,x;const{force:c=!1,city:i}=t,o="a55bf005791cbcd4b9066e2c59444adc",l=(i==null?void 0:i.name)||"Moscow",h=`current:${l}`;if(console.log("Weather API request:",{cityName:l,hasApiKey:!0}),!c){const f=T(h);if((f==null?void 0:f.data)!=null&&(f!=null&&f.ts)&&Date.now()-f.ts<V)return f.data}const p=T(h),{data:u}=await G.get(`${J}/weather`,{params:{q:l,APPID:o,units:"metric"},timeout:1e4}).catch(f=>{var y,w,C;if(f.code==="ECONNABORTED")throw new Error("Timeout: Weather API request took too long");if(((y=f.response)==null?void 0:y.status)===401)throw new Error("Invalid API key");if(((w=f.response)==null?void 0:w.status)===404)throw new Error("City not found");if(((C=f.response)==null?void 0:C.status)===429){if(p!=null&&p.data)return console.warn("API rate limit exceeded, using cached data"),{...p.data,isRateLimited:!0};throw new Error("Too many requests. Please wait before refreshing.")}throw new Error(`Weather API error: ${f.message}`)}),v={locationName:(u==null?void 0:u.name)??l,tempC:typeof((n=u==null?void 0:u.main)==null?void 0:n.temp)=="number"?u.main.temp:0,feelsLikeC:typeof((a=u==null?void 0:u.main)==null?void 0:a.feels_like)=="number"?u.main.feels_like:0,humidity:typeof((r=u==null?void 0:u.main)==null?void 0:r.humidity)=="number"?u.main.humidity:0,pressureHpa:typeof((j=u==null?void 0:u.main)==null?void 0:j.pressure)=="number"?u.main.pressure:0,windMs:typeof((g=u==null?void 0:u.wind)==null?void 0:g.speed)=="number"?u.wind.speed:0,condition:((x=(b=u==null?void 0:u.weather)==null?void 0:b[0])==null?void 0:x.description)??"‚Äî"};return console.log("Weather API result:",v),Z(h,{data:v,ts:Date.now()}),v}async function Ze(s,t={}){const{force:c=!1,city:i}=t,o="a55bf005791cbcd4b9066e2c59444adc",l=(i==null?void 0:i.name)||"Moscow",h=`forecast:${l}`;if(!c){const a=T(h);if((a==null?void 0:a.data)!=null&&(a!=null&&a.ts)&&Date.now()-a.ts<V)return a.data}const p=T(h),{data:u}=await G.get(`${J}/forecast`,{params:{q:l,APPID:o,units:"metric"},timeout:1e4}).catch(a=>{var r,j,g;if(a.code==="ECONNABORTED")throw new Error("Timeout: Forecast API request took too long");if(((r=a.response)==null?void 0:r.status)===401)throw new Error("Invalid API key");if(((j=a.response)==null?void 0:j.status)===404)throw new Error("City not found");if(((g=a.response)==null?void 0:g.status)===429){if(p!=null&&p.data)return console.warn("Forecast API rate limit exceeded, using cached data"),p.data.map(b=>({...b,isRateLimited:!0}));throw new Error("Too many requests. Please wait before refreshing.")}throw new Error(`Forecast API error: ${a.message}`)}),n=((u==null?void 0:u.list)??[]).slice(0,16).map(a=>{var f;const r=new Date(a.dt*1e3),j=r.getHours(),g=r.getMinutes(),b=`${String(j).padStart(2,"0")}:${String(g).padStart(2,"0")}`,x=typeof((f=a.main)==null?void 0:f.temp)=="number"?Math.round(a.main.temp):0;return{t:b,v:x}});return Z(h,{data:n,ts:Date.now()}),n}async function Je(s,t={}){const{force:c=!1,city:i}=t,o="a55bf005791cbcd4b9066e2c59444adc",l=(i==null?void 0:i.name)||"Moscow",h=`detailed:${l}`;if(!c){const a=T(h);if((a==null?void 0:a.data)!=null&&(a!=null&&a.ts)&&Date.now()-a.ts<V)return a.data}const p=T(h),{data:u}=await G.get(`${J}/forecast`,{params:{q:l,APPID:o,units:"metric"},timeout:1e4}).catch(a=>{var r,j,g;if(a.code==="ECONNABORTED")throw new Error("Timeout: Detailed forecast API request took too long");if(((r=a.response)==null?void 0:r.status)===401)throw new Error("Invalid API key");if(((j=a.response)==null?void 0:j.status)===404)throw new Error("City not found");if(((g=a.response)==null?void 0:g.status)===429){if(p!=null&&p.data)return console.warn("Detailed forecast API rate limit exceeded, using cached data"),p.data.map(b=>({...b,isRateLimited:!0}));throw new Error("Too many requests. Please wait before refreshing.")}throw new Error(`Detailed forecast API error: ${a.message}`)}),n=((u==null?void 0:u.list)??[]).slice(0,8).map(a=>{var r,j,g,b,x,f;return{dt:a.dt,temp:typeof((r=a.main)==null?void 0:r.temp)=="number"?Math.round(a.main.temp):0,condition:((g=(j=a==null?void 0:a.weather)==null?void 0:j[0])==null?void 0:g.description)??"‚Äî",humidity:typeof((b=a.main)==null?void 0:b.humidity)=="number"?a.main.humidity:0,windMs:typeof((x=a.wind)==null?void 0:x.speed)=="number"?a.wind.speed:0,pressure:typeof((f=a.main)==null?void 0:f.pressure)=="number"?a.main.pressure:0}});return Z(h,{data:n,ts:Date.now()}),n}function X(){const[s,t]=d.useState(null),[c,i]=d.useState(null);return d.useEffect(()=>{if(!("geolocation"in navigator)){i(new Error("Geolocation unsupported"));return}const o=navigator.geolocation.watchPosition(l=>{const h={lat:l.coords.latitude,lon:l.coords.longitude};console.log("Geolocation coords:",h),t(h),i(null)},l=>{console.warn("Geolocation error:",l),i(l)},{enableHighAccuracy:!0,maximumAge:6e4,timeout:1e4});return()=>navigator.geolocation.clearWatch(o)},[]),{coords:s,error:c}}function Ve(s){X();const[t,c]=d.useState(null),[i,o]=d.useState(!0),[l,h]=d.useState(null);console.log("useWeatherData: city prop:",s);const p=d.useCallback(async(v=!1)=>{console.log("useWeatherData: run called with city:",s,"force:",v),o(!0),h(null);try{const n=await Ge(null,{force:v,city:s||null});console.log("useWeatherData: got result:",n),c(n)}catch(n){console.log("useWeatherData: error:",n),h(n)}finally{o(!1)}},[s]);d.useEffect(()=>{p(!1)},[p]);const u=d.useCallback(()=>p(!0),[p]);return{data:t,loading:i,error:l,refetch:u}}function B(s){return typeof s!="number"||Number.isNaN(s)?"‚Äî":`${Math.round(s)}¬∞C`}function Xe(s){if(!(s instanceof Date)||Number.isNaN(s.getTime()))return"‚Äî";const t=s.getHours(),c=s.getMinutes();return`${String(t).padStart(2,"0")}:${String(c).padStart(2,"0")}`}function Ye({city:s}){const{data:t,loading:c,error:i,refetch:o}=Ve(s);return e.jsxs(M,{className:"widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx("h3",{className:"widget-title",children:"–°–µ–π—á–∞—Å"}),e.jsxs("div",{className:"widget-header-actions",children:[e.jsxs("span",{className:"muted",children:["–õ–æ–∫–∞—Ü–∏—è: ",(t==null?void 0:t.locationName)||"‚Äî"]}),e.jsx(Be,{type:"button",onClick:o,disabled:c,title:"–û–±–Ω–æ–≤–∏—Ç—å",children:i?"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å":"–û–±–Ω–æ–≤–∏—Ç—å"})]})]}),c&&e.jsx("div",{className:"skeleton widget-skeleton"}),!c&&i&&e.jsx("p",{className:"muted",children:"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–≥–æ–¥—É. –ü—Ä–æ–≤–µ—Ä—å API –∫–ª—é—á."}),!c&&!i&&t&&e.jsxs("div",{className:"current",children:[e.jsx("div",{className:"current-temp",children:B(t.tempC)}),e.jsx("div",{className:"muted",children:t.condition}),t.feelsLikeC!=null&&e.jsxs("div",{className:"muted",children:["–û—â—É—â–∞–µ—Ç—Å—è: ",B(t.feelsLikeC)]}),e.jsxs("div",{className:"current-meta",children:[e.jsxs("div",{children:[e.jsx("span",{className:"muted",children:"–í–ª–∞–∂–Ω–æ—Å—Ç—å"}),e.jsxs("div",{children:[t.humidity,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"muted",children:"–í–µ—Ç–µ—Ä"}),e.jsxs("div",{children:[t.windMs," –º/—Å"]})]}),t.pressureHpa!=null&&t.pressureHpa>0&&e.jsxs("div",{children:[e.jsx("span",{className:"muted",children:"–î–∞–≤–ª–µ–Ω–∏–µ"}),e.jsxs("div",{children:[t.pressureHpa," hPa"]})]})]})]})]})}function Qe(s){X();const[t,c]=d.useState(null),[i,o]=d.useState(!0),[l,h]=d.useState(null),p=d.useCallback(async(v=!1)=>{o(!0),h(null);try{const n=await Ze(null,{force:v,city:s||null});c(n)}catch(n){h(n)}finally{o(!1)}},[s]);d.useEffect(()=>{p(!1)},[p]);const u=d.useCallback(()=>p(!0),[p]);return{data:t,loading:i,error:l,refetch:u}}const et=[{t:"00:00",v:5},{t:"06:00",v:6},{t:"12:00",v:10},{t:"18:00",v:7}];function tt({city:s}){const{data:t,loading:c,error:i}=Qe(s),o=t!=null&&t.length?t:et;return e.jsxs(M,{className:"widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx("h3",{className:"widget-title",children:"–ü—Ä–æ–≥–Ω–æ–∑"}),e.jsx("span",{className:"muted",children:"–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, 3 —á"})]}),c&&e.jsx("div",{className:"skeleton widget-skeleton"}),!c&&i&&e.jsx("p",{className:"muted",children:"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑."}),!c&&!i&&o.length>0&&e.jsx("div",{style:{width:"100%",height:240},children:e.jsx(ge,{children:e.jsxs(xe,{data:o,children:[e.jsx(je,{dataKey:"t",stroke:"rgba(255,255,255,0.6)",fontSize:12}),e.jsx(ye,{stroke:"rgba(255,255,255,0.6)",fontSize:12}),e.jsx(ve,{contentStyle:{background:"rgba(15, 23, 42, 0.85)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:12},labelStyle:{color:"#f8fafc"},formatter:l=>[`${l} ¬∞C`,"–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞"]}),e.jsx(we,{type:"monotone",dataKey:"v",stroke:"#8b5cf6",strokeWidth:2,dot:!1})]})})})]})}delete ie.Icon.Default.prototype._getIconUrl;ie.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"});const st=[55.751244,37.618423],at=10;function nt({center:s}){const t=Me();return d.useEffect(()=>{s&&s[0]!=null&&s[1]!=null&&t.setView(s,t.getZoom())},[t,s]),null}function rt({city:s}){const t=s?[s.lat,s.lon]:st,c=!!s;return e.jsxs(M,{className:"widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx("h3",{className:"widget-title",children:"–ö–∞—Ä—Ç–∞"}),e.jsx("span",{className:"muted",children:c?s.name:"–¶–µ–Ω—Ç—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é"})]}),e.jsx("div",{className:"map-container",children:e.jsxs(Ne,{center:t,zoom:at,scrollWheelZoom:!0,style:{height:"100%",width:"100%"},children:[e.jsx(be,{attribution:'¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e.jsx(nt,{center:t}),c&&e.jsx(ke,{position:[s.lat,s.lon],children:e.jsxs(Se,{children:["–ü–æ–≥–æ–¥–∞ –≤ ",s.name]})})]})})]})}function it(s){X();const[t,c]=d.useState(null),[i,o]=d.useState(!0),[l,h]=d.useState(null),p=d.useCallback(async(v=!1)=>{o(!0),h(null);try{const n=await Je(null,{force:v,city:s||null});c(n)}catch(n){h(n)}finally{o(!1)}},[s]);d.useEffect(()=>{p(!1)},[p]);const u=d.useCallback(()=>p(!0),[p]);return{data:t,loading:i,error:l,refetch:u}}function ot({city:s}){const{data:t,loading:c,error:i}=it(s);return e.jsxs(M,{className:"widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx("h3",{className:"widget-title",children:"–ü–æ–¥—Ä–æ–±–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑"}),e.jsx("span",{className:"muted",children:"–ù–∞ –±–ª–∏–∂–∞–π—à–∏–µ 24 —á–∞—Å–∞"})]}),c&&e.jsx("div",{className:"skeleton widget-skeleton"}),!c&&i&&e.jsx("p",{className:"muted",children:"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑."}),!c&&!i&&t&&t.length>0&&e.jsx("div",{className:"detailed-forecast",children:e.jsx("div",{className:"forecast-list",children:t.map((o,l)=>e.jsxs("div",{className:"forecast-item",children:[e.jsx("div",{className:"forecast-time",children:Xe(new Date(o.dt*1e3))}),e.jsx("div",{className:"forecast-temp",children:B(o.temp)}),e.jsx("div",{className:"forecast-condition",children:o.condition}),e.jsxs("div",{className:"forecast-details",children:[e.jsxs("span",{className:"forecast-humidity",children:["üíß ",o.humidity,"%"]}),e.jsxs("span",{className:"forecast-wind",children:["üí® ",o.windMs," –º/—Å"]})]})]},l))})})]})}const _=[{name:"–ú–æ—Å–∫–≤–∞",country:"RU",lat:55.7558,lon:37.6173},{name:"–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",country:"RU",lat:59.9343,lon:30.3351},{name:"–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫",country:"RU",lat:55.0084,lon:82.9357},{name:"–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥",country:"RU",lat:56.8389,lon:60.6057},{name:"–ö–∞–∑–∞–Ω—å",country:"RU",lat:55.8304,lon:49.0661},{name:"London",country:"GB",lat:51.5074,lon:-.1278},{name:"Paris",country:"FR",lat:48.8566,lon:2.3522},{name:"New York",country:"US",lat:40.7128,lon:-74.006},{name:"Tokyo",country:"JP",lat:35.6762,lon:139.6503},{name:"Berlin",country:"DE",lat:52.52,lon:13.405}];function lt({onCitySelect:s,currentCity:t}){const[c,i]=d.useState(""),[o,l]=d.useState([]),[h,p]=d.useState(!1),[u,v]=d.useState(!1),[n,a]=d.useState([]),[r,j]=d.useState(!1),[g,b]=d.useState({top:0,left:0,width:0}),x=d.useRef(null),f=d.useRef(null),y=d.useRef(null);d.useEffect(()=>{try{const m=localStorage.getItem("favorite-cities");m&&a(JSON.parse(m))}catch{a([])}},[]);const w=d.useCallback(()=>{if(x.current&&h){const m=x.current.getBoundingClientRect();b({top:m.bottom+window.scrollY+8,left:m.left+window.scrollX,width:m.width})}},[h]);d.useEffect(()=>{if(h)return w(),window.addEventListener("scroll",w),window.addEventListener("resize",w),()=>{window.removeEventListener("scroll",w),window.removeEventListener("resize",w)}},[h,w]);const[C,A]=d.useState(0);d.useEffect(()=>{h&&A(m=>m+1)},[h]),d.useEffect(()=>{u&&!c?p(!0):!u&&!c&&document.activeElement!==x.current&&p(!1)},[u,c]);const D=()=>{v(!0)},I=()=>{v(!1)},H=m=>{try{localStorage.setItem("favorite-cities",JSON.stringify(m)),a(m)}catch{}};d.useEffect(()=>{const m=N=>{f.current&&!f.current.contains(N.target)&&p(!1)};return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[]);const $=async m=>{if(console.log("CitySearch: searchCities called with:",m),!m.trim()){console.log("CitySearch: empty query, showing popular cities"),l(_.slice(0,5));return}j(!0);try{const N="a55bf005791cbcd4b9066e2c59444adc";console.log("CitySearch: API key exists:",!!N);const R=await(await fetch(`//api.openweathermap.org/geo/1.0/direct?q=${encodeURIComponent(m)}&limit=5&appid=${N}`)).json();console.log("CitySearch: API response:",R);const P=R.map(z=>({name:z.name,country:z.country,lat:z.lat,lon:z.lon,state:z.state}));console.log("CitySearch: processed cities:",P),l(P)}catch(N){console.error("CitySearch: Error searching cities:",N);const S=_.filter(R=>R.name.toLowerCase().includes(m.toLowerCase()));l(S.slice(0,5))}finally{j(!1)}};d.useEffect(()=>{const m=setTimeout(()=>{c?$(c):l(_.slice(0,5))},300);return()=>clearTimeout(m)},[c]);const de=m=>{const N=m.target.value;console.log("CitySearch: input changed to:",N),i(N),p(!0),console.log("CitySearch: setIsOpen called with true")},Y=m=>{console.log("CitySearch: handleCitySelect called with:",m),console.log("CitySearch: onCitySelect exists:",!!s),i(m.name),p(!1),s?(console.log("CitySearch: calling onCitySelect"),s(m)):console.log("CitySearch: onCitySelect is undefined")},ue=()=>{var m;i(""),p(!1),(m=x.current)==null||m.focus()},he=()=>{console.log("CitySearch: input focused"),p(!0)},me=()=>{setTimeout(()=>{var m;!u&&!((m=f.current)!=null&&m.contains(document.activeElement))&&p(!1)},100)},Q=(m,N)=>{N.stopPropagation();const S=`${m.name},${m.country}`,R=n.some(P=>`${P.name},${P.country}`===S)?n.filter(P=>`${P.name},${P.country}`!==S):[...n,m];H(R)},W=m=>{const N=`${m.name},${m.country}`;return n.some(S=>`${S.name},${S.country}`===N)};return e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"city-search",children:e.jsx("div",{ref:y,className:"search-container",onMouseEnter:D,onMouseLeave:I,children:e.jsxs(E.div,{className:"search-input-wrapper",whileFocus:{scale:1.02},transition:{duration:.2},children:[e.jsx(E.div,{className:"search-icon",animate:{rotate:h?360:0},transition:{duration:.3},children:e.jsx(Oe,{size:18})}),e.jsx("input",{ref:x,type:"text",value:c,onChange:de,onFocus:he,onBlur:me,placeholder:"–ü–æ–∏—Å–∫ –≥–æ—Ä–æ–¥–∞...",className:"search-input"}),e.jsx(ee,{children:c&&e.jsx(E.button,{onClick:ue,className:"clear-button",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},transition:{duration:.2},whileHover:{scale:1.1,rotate:90},whileTap:{scale:.9},children:e.jsx(_e,{size:16})})})]})})}),e.jsx(ee,{children:h&&e.jsx(E.div,{ref:f,className:"search-dropdown",style:{position:"fixed",top:`${g.top}px`,left:`${g.left}px`,width:`${g.width}px`,background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.3)",zIndex:99999},initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.2,ease:[.4,0,.2,1]},onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),children:r?e.jsx(E.div,{className:"search-loading",initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},children:"–ó–∞–≥—Ä—É–∑–∫–∞..."}):e.jsxs(e.Fragment,{children:[n.length>0&&e.jsxs(E.div,{className:"search-section",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},children:[e.jsx("div",{className:"search-section-title",children:"–ò–∑–±—Ä–∞–Ω–Ω–æ–µ"}),n.map((m,N)=>e.jsxs(E.div,{className:"search-item favorite",onClick:()=>Y(m),initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1+N*.05},whileHover:{scale:1.02,x:5},whileTap:{scale:.98},children:[e.jsx(K,{size:16}),e.jsxs("div",{className:"search-item-info",children:[e.jsx("div",{className:"search-item-name",children:m.name}),e.jsx("div",{className:"search-item-country",children:m.country})]}),e.jsx(E.button,{onClick:S=>{S.stopPropagation(),Q(m,S)},className:"favorite-button active",whileHover:{scale:1.2,rotate:72},whileTap:{scale:.9},children:e.jsx(ae,{size:16,fill:"currentColor"})})]},`fav-${N}-${C}`))]}),e.jsxs(E.div,{className:"search-section",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},children:[e.jsx("div",{className:"search-section-title",children:c?"–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞":"–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –≥–æ—Ä–æ–¥–∞"}),o.map((m,N)=>e.jsxs(E.div,{className:"search-item",onClick:()=>{console.log("CitySearch: clicked on city:",m),Y(m)},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2+N*.05},whileHover:{scale:1.02,x:5},whileTap:{scale:.98},children:[e.jsx(K,{size:16}),e.jsxs("div",{className:"search-item-info",children:[e.jsx("div",{className:"search-item-name",children:m.name}),e.jsxs("div",{className:"search-item-country",children:[m.state?`${m.state}, `:"",m.country]})]}),e.jsx(E.button,{onClick:S=>{S.stopPropagation(),Q(m,S)},className:`favorite-button ${W(m)?"active":""}`,whileHover:{scale:1.2,rotate:W(m)?72:0},whileTap:{scale:.9},children:e.jsx(ae,{size:16,fill:W(m)?"currentColor":"none"})})]},`sug-${N}-${C}`))]})]})},`dropdown-${C}`)})]})}function ct({weather:s="clear"}){const t=d.useRef(null);d.useRef(null);const c=d.useRef([]);return d.useEffect(()=>{const i=t.current;if(!i)return;const o=i.getContext("2d");let l;const h=()=>{i.width=window.innerWidth,i.height=window.innerHeight};h(),window.addEventListener("resize",h);const p=()=>{switch(s){case"rain":return{count:100,speed:{min:5,max:10},size:{min:1,max:3},opacity:{min:.3,max:.8},color:"rgba(174, 194, 224, 0.6)"};case"snow":return{count:80,speed:{min:1,max:3},size:{min:2,max:6},opacity:{min:.4,max:.9},color:"rgba(255, 255, 255, 0.8)"};case"cloudy":return{count:20,speed:{min:.2,max:.8},size:{min:30,max:80},opacity:{min:.1,max:.3},color:"rgba(255, 255, 255, 0.4)"};default:return{count:30,speed:{min:.1,max:.5},size:{min:20,max:60},opacity:{min:.05,max:.15},color:"rgba(255, 255, 255, 0.3)"}}};class u{constructor(r){this.reset(r)}reset(r){this.x=Math.random()*i.width,this.y=Math.random()*i.height-i.height,this.size=Math.random()*(r.size.max-r.size.min)+r.size.min,this.speed=Math.random()*(r.speed.max-r.speed.min)+r.speed.min,this.opacity=Math.random()*(r.opacity.max-r.opacity.min)+r.opacity.min,this.color=r.color,this.angle=Math.random()*Math.PI*2,this.angleSpeed=(Math.random()-.5)*.02}update(r){s==="rain"?(this.y+=this.speed,this.x+=Math.sin(this.angle)*.5,this.angle+=this.angleSpeed):s==="snow"?(this.y+=this.speed,this.x+=Math.sin(this.angle)*2,this.angle+=this.angleSpeed):(this.y+=this.speed*.3,this.x+=Math.sin(this.angle)*.5,this.angle+=this.angleSpeed*.5),this.y>i.height+50&&(this.y=-50,this.x=Math.random()*i.width),this.x>i.width+50&&(this.x=-50),this.x<-50&&(this.x=i.width+50)}draw(r){if(r.save(),r.globalAlpha=this.opacity,r.fillStyle=this.color,s==="rain")r.beginPath(),r.moveTo(this.x,this.y),r.lineTo(this.x,this.y+this.size*3),r.strokeStyle=this.color,r.lineWidth=this.size,r.stroke();else if(s==="snow"){r.beginPath(),r.arc(this.x,this.y,this.size,0,Math.PI*2),r.fill(),r.strokeStyle=this.color,r.lineWidth=1;for(let j=0;j<6;j++){const g=Math.PI*2/6*j;r.beginPath(),r.moveTo(this.x,this.y),r.lineTo(this.x+Math.cos(g)*this.size*2,this.y+Math.sin(g)*this.size*2),r.stroke()}}else r.beginPath(),r.arc(this.x,this.y,this.size,0,Math.PI*2),r.fill();r.restore()}}const v=p();c.current=Array.from({length:v.count},()=>new u(v));const n=()=>{o.clearRect(0,0,i.width,i.height),c.current.forEach(a=>{a.update(v),a.draw(o)}),l=requestAnimationFrame(n)};return n(),()=>{cancelAnimationFrame(l),window.removeEventListener("resize",h)}},[s]),e.jsx("canvas",{ref:t,className:"weather-background",style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:1}})}function dt({city:s}){const[t,c]=d.useState(null),[i,o]=d.useState(!0);d.useEffect(()=>{s&&(async()=>{o(!0),await new Promise(n=>setTimeout(n,1e3));const v={aqi:Math.floor(Math.random()*150)+20,pm25:Math.random()*50+10,pm10:Math.random()*80+20,o3:Math.random()*100+40,no2:Math.random()*60+10,so2:Math.random()*20+5,co:Math.random()*2+.5};c(v),o(!1)})()},[s]);const l=u=>u<=50?{level:"–•–æ—Ä–æ—à–µ–µ",color:"#10b981",icon:Le}:u<=100?{level:"–£–º–µ—Ä–µ–Ω–Ω–æ–µ",color:"#f59e0b",icon:O}:u<=150?{level:"–í—Ä–µ–¥–Ω–æ–µ –¥–ª—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –≥—Ä—É–ø–ø",color:"#f97316",icon:L}:u<=200?{level:"–ù–µ–∑–¥–æ—Ä–æ–≤–æ–µ",color:"#ef4444",icon:L}:u<=300?{level:"–û—á–µ–Ω—å –Ω–µ–∑–¥–æ—Ä–æ–≤–æ–µ",color:"#7c3aed",icon:L}:{level:"–û–ø–∞—Å–Ω–æ–µ",color:"#991b1b",icon:L};if(i)return e.jsxs(M,{className:"air-quality-widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx(O,{size:20}),e.jsx("h3",{children:"–ö–∞—á–µ—Å—Ç–≤–æ –≤–æ–∑–¥—É—Ö–∞"})]}),e.jsxs("div",{className:"loading-content",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."})]})]});if(!t)return e.jsxs(M,{className:"air-quality-widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx(O,{size:20}),e.jsx("h3",{children:"–ö–∞—á–µ—Å—Ç–≤–æ –≤–æ–∑–¥—É—Ö–∞"})]}),e.jsxs("div",{className:"error-content",children:[e.jsx(L,{size:24}),e.jsx("p",{children:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö"})]})]});const h=l(t.aqi),p=h.icon;return e.jsxs(M,{className:"air-quality-widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx(O,{size:20}),e.jsx("h3",{children:"–ö–∞—á–µ—Å—Ç–≤–æ –≤–æ–∑–¥—É—Ö–∞"})]}),e.jsxs("div",{className:"air-quality-content",children:[e.jsxs("div",{className:"aqi-main",children:[e.jsx("div",{className:"aqi-value",style:{color:h.color},children:t.aqi}),e.jsxs("div",{className:"aqi-level",children:[e.jsx(p,{size:16,style:{color:h.color}}),e.jsx("span",{style:{color:h.color},children:h.level})]})]}),e.jsxs("div",{className:"pollutants-grid",children:[e.jsxs("div",{className:"pollutant-item",children:[e.jsx("div",{className:"pollutant-name",children:"PM2.5"}),e.jsx("div",{className:"pollutant-value",children:t.pm25.toFixed(1)})]}),e.jsxs("div",{className:"pollutant-item",children:[e.jsx("div",{className:"pollutant-name",children:"PM10"}),e.jsx("div",{className:"pollutant-value",children:t.pm10.toFixed(1)})]}),e.jsxs("div",{className:"pollutant-item",children:[e.jsx("div",{className:"pollutant-name",children:"O‚ÇÉ"}),e.jsx("div",{className:"pollutant-value",children:t.o3.toFixed(1)})]}),e.jsxs("div",{className:"pollutant-item",children:[e.jsx("div",{className:"pollutant-name",children:"NO‚ÇÇ"}),e.jsx("div",{className:"pollutant-value",children:t.no2.toFixed(1)})]})]}),e.jsxs("div",{className:"air-quality-tips",children:[e.jsx("h4",{children:"–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:"}),t.aqi<=50&&e.jsx("p",{children:"–û—Ç–ª–∏—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –ø—Ä–æ–≥—É–ª–æ–∫ –∏ –∑–∞–Ω—è—Ç–∏–π —Å–ø–æ—Ä—Ç–æ–º –Ω–∞ —Å–≤–µ–∂–µ–º –≤–æ–∑–¥—É—Ö–µ."}),t.aqi>50&&t.aqi<=100&&e.jsx("p",{children:"–ü—Ä–∏–µ–º–ª–µ–º–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤–æ–∑–¥—É—Ö–∞. –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –ª—é–¥—è–º —Å–ª–µ–¥—É–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≥—É–ª–∫–∏."}),t.aqi>100&&t.aqi<=150&&e.jsx("p",{children:"–õ—é–¥—è–º —Å —Ä–µ—Å–ø–∏—Ä–∞—Ç–æ—Ä–Ω—ã–º–∏ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º–∏ —Å–ª–µ–¥—É–µ—Ç –∏–∑–±–µ–≥–∞—Ç—å —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫ –Ω–∞ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–æ–∑–¥—É—Ö–µ."}),t.aqi>150&&e.jsx("p",{children:"–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –≤ –ø–æ–º–µ—â–µ–Ω–∏–∏. –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ –Ω–∞ —É–ª–∏—Ü—É –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞—â–∏—Ç–Ω—É—é –º–∞—Å–∫—É."})]})]})]})}function ut({city:s}){const t=d.useRef(null),[c,i]=d.useState(!0),[o,l]=d.useState(null),h=d.useRef(null);d.useEffect(()=>{s&&(async()=>{i(!0),await new Promise(r=>setTimeout(r,1500));const a={center:{lat:(s==null?void 0:s.lat)||55.7558,lon:(s==null?void 0:s.lon)||37.6173},precipitation:p(),timestamp:new Date().toISOString()};l(a),i(!1)})()},[s]);const p=()=>{const n=[];for(let a=0;a<50;a++)n.push({x:Math.random()*300-150,y:Math.random()*300-150,intensity:Math.random(),type:Math.random()>.7?"rain":Math.random()>.9?"storm":"cloud",size:Math.random()*30+10,speed:Math.random()*2+.5,direction:Math.random()*Math.PI*2});return n};d.useEffect(()=>{if(!o||!t.current)return;const n=t.current,a=n.getContext("2d");n.width=300,n.height=300;let r=0;const j=()=>{a.clearRect(0,0,n.width,n.height),u(a,n.width,n.height),o.precipitation.forEach((g,b)=>{const x=n.width/2+g.x+Math.cos(g.direction)*r*g.speed,f=n.height/2+g.y+Math.sin(g.direction)*r*g.speed;let y;g.type==="storm"?y=`rgba(147, 51, 234, ${g.intensity*.8})`:g.type==="rain"?y=`rgba(59, 130, 246, ${g.intensity*.6})`:y=`rgba(156, 163, 175, ${g.intensity*.3})`,a.save(),a.globalAlpha=g.intensity*.7,a.fillStyle=y;const w=a.createRadialGradient(x,f,0,x,f,g.size);w.addColorStop(0,y),w.addColorStop(1,"transparent"),a.fillStyle=w,a.beginPath(),a.arc(x,f,g.size,0,Math.PI*2),a.fill(),a.restore()}),v(a,n.width/2,n.height/2),r+=.1,h.current=requestAnimationFrame(j)};return j(),()=>{h.current&&cancelAnimationFrame(h.current)}},[o]);const u=(n,a,r)=>{n.strokeStyle="rgba(255, 255, 255, 0.1)",n.lineWidth=1;for(let j=1;j<=4;j++)n.beginPath(),n.arc(a/2,r/2,a/2*(j/4),0,Math.PI*2),n.stroke();for(let j=0;j<8;j++){const g=Math.PI*2/8*j;n.beginPath(),n.moveTo(a/2,r/2),n.lineTo(a/2+Math.cos(g)*a/2,r/2+Math.sin(g)*r/2),n.stroke()}n.fillStyle="rgba(255, 255, 255, 0.6)",n.font="10px sans-serif",n.fillText("25 –∫–º",a/2+5,r/2-a/4),n.fillText("50 –∫–º",a/2+5,r/2-a/2),n.fillText("75 –∫–º",a/2+5,r/2-a*3/4)},v=(n,a,r)=>{n.fillStyle="#ef4444",n.beginPath(),n.arc(a,r,5,0,Math.PI*2),n.fill(),n.strokeStyle="#ef4444",n.lineWidth=2,n.globalAlpha=.5,n.beginPath(),n.arc(a,r,10,0,Math.PI*2),n.stroke(),n.globalAlpha=1};return c?e.jsxs(M,{className:"radar-widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx(se,{size:20}),e.jsx("h3",{children:"–†–∞–¥–∞—Ä –æ—Å–∞–¥–∫–æ–≤"})]}),e.jsxs("div",{className:"loading-content",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞–¥–∞—Ä–∞..."})]})]}):e.jsxs(M,{className:"radar-widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx(se,{size:20}),e.jsx("h3",{children:"–†–∞–¥–∞—Ä –æ—Å–∞–¥–∫–æ–≤"})]}),e.jsxs("div",{className:"radar-content",children:[e.jsx("div",{className:"radar-container",children:e.jsx("canvas",{ref:t,className:"radar-canvas",style:{width:"100%",height:"300px",borderRadius:"8px"}})}),e.jsxs("div",{className:"radar-legend",children:[e.jsx("div",{className:"legend-title",children:"–ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –æ—Å–∞–¥–∫–æ–≤"}),e.jsxs("div",{className:"legend-items",children:[e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-color",style:{background:"rgba(156, 163, 175, 0.5)"}}),e.jsx("span",{children:"–û–±–ª–∞—á–Ω–æ"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-color",style:{background:"rgba(59, 130, 246, 0.6)"}}),e.jsx("span",{children:"–î–æ–∂–¥—å"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-color",style:{background:"rgba(147, 51, 234, 0.8)"}}),e.jsx("span",{children:"–ì—Ä–æ–∑–∞"})]})]})]}),e.jsxs("div",{className:"radar-info",children:[e.jsxs("div",{className:"info-item",children:[e.jsx(K,{size:14}),e.jsx("span",{children:(s==null?void 0:s.name)||"–ú–æ—Å–∫–≤–∞"})]}),e.jsxs("div",{className:"info-item",children:[e.jsx(ze,{size:14}),e.jsxs("span",{children:["–û–±–Ω–æ–≤–ª–µ–Ω: ",new Date().toLocaleTimeString()]})]})]})]})]})}function ht({city:s}){const[t,c]=d.useState(null),[i,o]=d.useState(!0),[l,h]=d.useState(new Date);d.useEffect(()=>{s&&(async()=>{o(!0),await new Promise(I=>setTimeout(I,800));const f=new Date,y=(s==null?void 0:s.lat)||55.7558,w=(s==null?void 0:s.lon)||37.6173,C=p(y,w,f,!0),A=p(y,w,f,!1),D=a(f);c({sunrise:C,sunset:A,moonPhase:D,daylightHours:u(C,A),currentTime:f,nextSunrise:v(C,f),nextSunset:n(A,f)}),o(!1)})()},[s]),d.useEffect(()=>{const x=setInterval(()=>{h(new Date)},1e3);return()=>clearInterval(x)},[]);const p=(x,f,y,w)=>{const C=w?6:18,A=x/90*2,D=Math.sin((y.getMonth()+1)*Math.PI/6)*1.5,I=C+A+D+(Math.random()-.5)*.5,H=Math.floor(I%1*60),$=new Date(y);return $.setHours(Math.floor(I),H,0,0),$},u=(x,f)=>(f-x)/(1e3*60*60),v=(x,f)=>{const y=new Date(x);return y<=f&&y.setDate(y.getDate()+1),y},n=(x,f)=>{const y=new Date(x);return y<=f&&y.setDate(y.getDate()+1),y},a=x=>{const f=["üåë","üåí","üåì","üåî","üåï","üåñ","üåó","üåò"],y=x.getDate();return f[y%8]},r=x=>{const f=x-l,y=Math.floor(f/(1e3*60*60)),w=Math.floor(f%(1e3*60*60)/(1e3*60));return y>0?`${y}—á ${w}–º`:`${w}–º`},j=x=>x?He:We,g=()=>t?l>=t.sunrise&&l<=t.sunset:!0;if(i)return e.jsxs(M,{className:"sun-times-widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx(q,{size:20}),e.jsx("h3",{children:"–°–æ–ª–Ω—Ü–µ –∏ –ª—É–Ω–∞"})]}),e.jsxs("div",{className:"loading-content",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."})]})]});if(!t)return e.jsxs(M,{className:"sun-times-widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx(q,{size:20}),e.jsx("h3",{children:"–°–æ–ª–Ω—Ü–µ –∏ –ª—É–Ω–∞"})]}),e.jsxs("div",{className:"error-content",children:[e.jsx(q,{size:24}),e.jsx("p",{children:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö"})]})]});const b=j(!0);return e.jsxs(M,{className:"sun-times-widget",children:[e.jsxs("div",{className:"widget-header",children:[e.jsx(q,{size:20}),e.jsx("h3",{children:"–°–æ–ª–Ω—Ü–µ –∏ –ª—É–Ω–∞"})]}),e.jsxs("div",{className:"sun-times-content",children:[e.jsxs("div",{className:"current-state",children:[e.jsx("div",{className:"state-icon",children:g()?e.jsxs("div",{className:"sun-icon-animated",children:[e.jsx(Fe,{size:32}),e.jsx("div",{className:"sun-rays"})]}):e.jsxs("div",{className:"moon-icon-animated",children:[e.jsx(qe,{size:32}),e.jsx("div",{className:"moon-glow"})]})}),e.jsxs("div",{className:"state-info",children:[e.jsx("div",{className:"state-label",children:g()?"–î–µ–Ω—å":"–ù–æ—á—å"}),e.jsx("div",{className:"state-time",children:l.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"sun-events",children:[e.jsxs("div",{className:"sun-event",children:[e.jsx("div",{className:"event-icon",children:e.jsx(b,{size:20})}),e.jsxs("div",{className:"event-info",children:[e.jsx("div",{className:"event-label",children:"–í–æ—Å—Ö–æ–¥"}),e.jsx("div",{className:"event-time",children:t.sunrise.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}),e.jsx("div",{className:"event-countdown",children:l<t.sunrise?`—á–µ—Ä–µ–∑ ${r(t.nextSunrise)}`:`–±—ã–ª ${r(l-t.sunrise)} –Ω–∞–∑–∞–¥`})]})]}),e.jsxs("div",{className:"sun-event",children:[e.jsx("div",{className:"event-icon",children:e.jsx(b,{size:20})}),e.jsxs("div",{className:"event-info",children:[e.jsx("div",{className:"event-label",children:"–ó–∞–∫–∞—Ç"}),e.jsx("div",{className:"event-time",children:t.sunset.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}),e.jsx("div",{className:"event-countdown",children:l<t.sunset?`—á–µ—Ä–µ–∑ ${r(t.nextSunset)}`:`–±—ã–ª ${r(l-t.sunset)} –Ω–∞–∑–∞–¥`})]})]})]}),e.jsxs("div",{className:"day-info",children:[e.jsxs("div",{className:"day-stat",children:[e.jsx("div",{className:"stat-label",children:"–°–≤–µ—Ç–æ–≤–æ–π –¥–µ–Ω—å"}),e.jsxs("div",{className:"stat-value",children:[Math.floor(t.daylightHours),"—á ",Math.floor(t.daylightHours%1*60),"–º"]})]}),e.jsxs("div",{className:"day-stat",children:[e.jsx("div",{className:"stat-label",children:"–§–∞–∑–∞ –ª—É–Ω—ã"}),e.jsx("div",{className:"stat-value",children:e.jsx("span",{className:"moon-emoji",children:t.moonPhase})})]})]}),e.jsxs("div",{className:"day-progress",children:[e.jsx("div",{className:"progress-label",children:"–ü—Ä–æ–≥—Ä–µ—Å—Å –¥–Ω—è"}),e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:`${(l-t.sunrise)/(t.sunset-t.sunrise)*100}%`,background:g()?"linear-gradient(90deg, #f59e0b, #ef4444)":"linear-gradient(90deg, #6366f1, #8b5cf6)"}})}),e.jsxs("div",{className:"progress-percentage",children:[Math.floor((l-t.sunrise)/(t.sunset-t.sunrise)*100),"%"]})]})]})]})}function mt({checked:s,onChange:t,label:c}){return e.jsxs("label",{className:"toggle",children:[e.jsx("input",{className:"toggle-input",type:"checkbox",checked:s,onChange:t}),e.jsx("span",{className:"toggle-track","aria-hidden":"true",children:e.jsx("span",{className:"toggle-thumb"})}),e.jsx("span",{className:"toggle-label",children:c})]})}const ne="atmosvibe-theme";function pt(){const s=d.useMemo(()=>{if(typeof window>"u")return"dark";const o=window.localStorage.getItem(ne);return o==="light"||o==="dark"?o:window.matchMedia&&window.matchMedia("(prefers-color-scheme: light)").matches?"light":"dark"},[]),[t,c]=d.useState(s);return d.useEffect(()=>{document.documentElement.dataset.theme=t,window.localStorage.setItem(ne,t)},[t]),{theme:t,toggleTheme:()=>c(o=>o==="light"?"dark":"light")}}function ft(){const[s,t]=d.useState({name:"–ú–æ—Å–∫–≤–∞",country:"RU",lat:55.7558,lon:37.6173}),{theme:c,toggleTheme:i}=pt(),o=d.useCallback(l=>{console.log("App: handleCitySelect called with:",l),t({name:l.name,country:l.country,lat:l.lat,lon:l.lon}),console.log("App: setSelectedCity called, new city:",l.name)},[]);return e.jsxs("div",{className:"app","data-theme":c,children:[e.jsx(ct,{weather:"clear"}),e.jsx("div",{className:"background"}),e.jsx(Ue,{onToggleTheme:i,theme:c}),e.jsxs("main",{className:"container safe-area-top safe-area-left safe-area-right",children:[e.jsxs("div",{className:"toolbar",children:[e.jsx(lt,{onCitySelect:o,currentCity:s}),e.jsx(mt,{checked:c==="light",onChange:i,label:"Light"})]}),e.jsxs("section",{className:"grid-responsive",children:[e.jsx(Ye,{city:s}),e.jsx(tt,{city:s}),e.jsx(rt,{city:s}),e.jsx(ot,{city:s}),e.jsx(dt,{city:s}),e.jsx(ut,{city:s}),e.jsx(ht,{city:s})]})]}),e.jsx(Ke,{})]})}function gt(){return e.jsx(ft,{})}function xt(){"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./service-worker.js").catch(()=>{})})}xt();U.createRoot(document.getElementById("root")).render(e.jsx(pe.StrictMode,{children:e.jsx(gt,{})}));
//# sourceMappingURL=index-Bg75vVMt.js.map
